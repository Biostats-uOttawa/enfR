<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr-fr" xml:lang="fr-fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Julien Martin">
<meta name="description" content="En cours de traduction">
<title>11&nbsp; ANOVA √† un crit√®re de classification ‚Äì Sur le chemin de l'enf-R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./34-anova_mult.html" rel="next">
<link href="./32-t_test.html" rel="prev">
<link href="./images/cover/book_fav.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-6561bbde787c299e21493071c8edc6ff.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c0dc7ac2c5723ded4848ec98b3ba37c0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de r√©sultats",
    "search-matching-documents-text": "documents trouv√©s",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SLXFYRXJR4"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SLXFYRXJR4', { 'anonymize_ip': true});
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><img src="images/cover/book_hex_fr.png" class="img-fluid" width="50"> Chemin enf-R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Recherche"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-flag" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-flag" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bi-flag">
<li>
    <a class="dropdown-item" href="https://biostats-uottawa.github.io/Rway/33-anova.html">
 <span class="dropdown-text">English</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link active" href="./902-donnees.html" aria-current="page"> 
<span class="menu-text">Donn√©es</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/"> 
<span class="menu-text">Biostats uOttawa</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/bioXx58/"> 
<span class="menu-text">Biostats with R (BioXx58)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/bio8940/"> 
<span class="menu-text">Biostats avanc√©es et science ouverte (Bio8940)</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/biostats-uottawa/enfR/" title="Code source" class="quarto-navigation-tool px-1" aria-label="Code source"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="T√©l√©charger" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="T√©l√©charger"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./Sur-le-chemin-de-l-enf-R.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            T√©l√©charger PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./Sur-le-chemin-de-l-enf-R.epub">
              <i class="bi bi-journal pe-1"></i>
            T√©l√©charger ePub
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Basculer le mode sombre"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Basculer en mode lecteur">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre lat√©rale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./31-reg_lin.html">Mod√®les lin√©aires</a></li><li class="breadcrumb-item"><a href="./33-anova.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ANOVA √† un crit√®re de classification</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre lat√©rale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pr√©face</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Utiliser R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-debut.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Pour commencer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-base.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Quelques notions de base sur R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-donnees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Donn√©es</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-graphique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Figures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-programmation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Programmation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Rapports reproductibles avec Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Contr√¥le de version avec Git et GitHub</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Principes de statistique</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-puissance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Analyse de puissance avec R et G*Power</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Mod√®les lin√©aires</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31-reg_lin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Corr√©lation et r√©gression lin√©aire simple</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32-t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Comparaison de deux √©chantillons</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33-anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ANOVA √† un crit√®re de classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34-anova_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">ANOVA √† crit√®res multiples : plans factoriels et hi√©rarchiques</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./35-reg_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">R√©gression multiple</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./36-ancova_glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">ANCOVA et mod√®le lin√©aire g√©n√©ral</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Mod√®les lin√©aires g√©n√©ralis√©s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./42-model_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Analyse de donn√©es de fr√©quence: Tableaux de contingence, mod√®les log-lin√©aires et r√©gression de Poisson</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Mod√®les mixtes</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Mod√®les additifs g√©n√©ralis√©s</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Analyses multivari√©es</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Approche Bayesienne</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./901-bibliographie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R√©f√©rences</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Annexes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./902-donnees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Donn√©es utilis√©es dans le livre</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des mati√®res</h2>
   
  <ul>
<li><a href="#set-ano" id="toc-set-ano" class="nav-link active" data-scroll-target="#set-ano"><span class="header-section-number">11.1</span> Paquets et donn√©es requises pour le labo</a></li>
  <li>
<a href="#anova-%C3%A0-un-crit%C3%A8re-de-classification-et-comparaisons-multiples" id="toc-anova-√†-un-crit√®re-de-classification-et-comparaisons-multiples" class="nav-link" data-scroll-target="#anova-%C3%A0-un-crit%C3%A8re-de-classification-et-comparaisons-multiples"><span class="header-section-number">11.2</span> ANOVA √† un crit√®re de classification et comparaisons multiples</a>
  <ul class="collapse">
<li><a href="#visualiser-les-donn%C3%A9es" id="toc-visualiser-les-donn√©es" class="nav-link" data-scroll-target="#visualiser-les-donn%C3%A9es"><span class="header-section-number">11.2.1</span> Visualiser les donn√©es</a></li>
  <li><a href="#v%C3%A9rifier-les-conditions-dapplication-de-lanova-param%C3%A9trique" id="toc-v√©rifier-les-conditions-dapplication-de-lanova-param√©trique" class="nav-link" data-scroll-target="#v%C3%A9rifier-les-conditions-dapplication-de-lanova-param%C3%A9trique"><span class="header-section-number">11.2.2</span> V√©rifier les conditions d‚Äôapplication de l‚ÄôANOVA param√©trique</a></li>
  <li><a href="#faire-lanova" id="toc-faire-lanova" class="nav-link" data-scroll-target="#faire-lanova"><span class="header-section-number">11.2.3</span> Faire l‚ÄôANOVA</a></li>
  <li><a href="#les-comparaisons-multiples" id="toc-les-comparaisons-multiples" class="nav-link" data-scroll-target="#les-comparaisons-multiples"><span class="header-section-number">11.2.4</span> Les comparaisons multiples</a></li>
  </ul>
</li>
  <li><a href="#transformations-de-donn%C3%A9es-et-anova-non-param%C3%A9trique" id="toc-transformations-de-donn√©es-et-anova-non-param√©trique" class="nav-link" data-scroll-target="#transformations-de-donn%C3%A9es-et-anova-non-param%C3%A9trique"><span class="header-section-number">11.3</span> Transformations de donn√©es et ANOVA non-param√©trique</a></li>
  <li><a href="#examen-des-valeurs-extr%C3%AAmes" id="toc-examen-des-valeurs-extr√™mes" class="nav-link" data-scroll-target="#examen-des-valeurs-extr%C3%AAmes"><span class="header-section-number">11.4</span> Examen des valeurs extr√™mes</a></li>
  <li><a href="#test-de-permutation" id="toc-test-de-permutation" class="nav-link" data-scroll-target="#test-de-permutation"><span class="header-section-number">11.5</span> Test de permutation</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/biostats-uottawa/enfR/edit/main/33-anova.qmd" class="toc-action"><i class="bi bi-github"></i>Modifier cette page</a></li><li><a href="https://github.com/biostats-uottawa/enfR/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un probl√®me</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./31-reg_lin.html">Mod√®les lin√©aires</a></li><li class="breadcrumb-item"><a href="./33-anova.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ANOVA √† un crit√®re de classification</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ANOVA √† un crit√®re de classification</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Objectifs de ce chapitre :</p>
<ul>
<li>Utiliser R pour effectuer une analyse de variance (ANOVA) param√©trique √† un crit√®re de classification, suivie de comparaisons multiples.</li>
<li>Utiliser R pour v√©rifier si les conditions d‚Äôapplication de l‚ÄôANOVA param√©trique sont remplies.</li>
<li>Utiliser R pour faire une ANOVA √† un crit√®re de classification non-param√©trique.</li>
<li>Utiliser R pour transformer des donn√©es de mani√®re √† mieux remplir les conditions d‚Äôapplication de l‚ÄôANOVA param√©trique.</li>
</ul>
<section id="set-ano" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="set-ano">
<span class="header-section-number">11.1</span> Paquets et donn√©es requises pour le labo</h2>
<p>Pour ce laboratoire, vous aurez besoin de :</p>
<ul>
<li>Paquets R :
<ul>
<li>
<code>ggplot2</code> <span class="emoji" data-emoji="package">üì¶</span>
</li>
<li>
<code>multcomp</code> <span class="emoji" data-emoji="package">üì¶</span>
</li>
<li>
<code>car</code> <span class="emoji" data-emoji="package">üì¶</span>
</li>
</ul>
</li>
<li>Jeu de donn√©es :
<ul>
<li>‚ÄúDam10dat.csv‚Äù</li>
</ul>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org">multcomp</a></span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="anova-√†-un-crit√®re-de-classification-et-comparaisons-multiples" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="anova-√†-un-crit√®re-de-classification-et-comparaisons-multiples">
<span class="header-section-number">11.2</span> ANOVA √† un crit√®re de classification et comparaisons multiples</h2>
<p>L‚ÄôANOVA √† un crit√®re de classification est l‚Äôanalogue du test de t pour des comparaisons de moyennes de plus de deux √©chantillons. Les conditions d‚Äôapplication du test sont essentiellement les m√™mes, et lorsque appliqu√© √† deux √©chantillons ce test est math√©matiquement √©quivalent au test de t.</p>
<p>En 1961-1962, le barrage Grand Rapids √©tait construit sur la rivi√®re Saskatchewan en amont de Cumberland House. Certains rapports indiqueraient que durant la construction, plusieurs gros esturgeons rest√®rent prisonniers dans des sections peu profondes et moururent. Des inventaires de la population d‚Äôesturgeons furent faits en 1954, 1958, 1965 et 1966. Au cours de ces inventaires, la longueur √† la fourche (frklngth) a √©t√© mesur√©e (pas n√©cessairement sur chaque poisson cependant). Ces donn√©es sont contenues dans le fichier <code>Dam10dat.csv</code>.</p>
<section id="visualiser-les-donn√©es" class="level3" data-number="11.2.1"><h3 data-number="11.2.1" class="anchored" data-anchor-id="visualiser-les-donn√©es">
<span class="header-section-number">11.2.1</span> Visualiser les donn√©es</h3>
<ul>
<li>√Ä partir des donn√©es (<code>Dam10dat</code>), il faut d‚Äôabord changer le type de donn√©e de la variable <code>year</code>, pour que R la traite comme un facteur (<code><a href="https://rdrr.io/r/base/factor.html">as.factor()</a></code>) plut√¥t que comme une variable continue.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Dam10dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/Dam10dat.csv"</span><span class="op">)</span></span>
<span><span class="va">Dam10dat</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Dam10dat</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">Dam10dat</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   118 obs. of  21 variables:
 $ year    : Factor w/ 4 levels "1954","1958",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ fklngth : num  45 50 39 46 54.5 49 42.5 49 56 54 ...
 $ totlngth: num  49 NA 43 50.5 NA 51.7 45.5 52 60.2 58.5 ...
 $ drlngth : logi  NA NA NA NA NA NA ...
 $ drwght  : num  16 20.5 10 17.5 19.7 21.3 9.5 23.7 31 27.3 ...
 $ rdwght  : num  24.5 33 15.5 28.5 32.5 35.5 15.3 40.5 51.5 43 ...
 $ sex     : int  1 1 1 2 1 2 1 1 1 1 ...
 $ age     : int  24 33 17 31 37 44 23 34 33 47 ...
 $ lfkl    : num  1.65 1.7 1.59 1.66 1.74 ...
 $ ltotl   : num  1.69 NA 1.63 1.7 NA ...
 $ ldrl    : logi  NA NA NA NA NA NA ...
 $ ldrwght : num  1.2 1.31 1 1.24 1.29 ...
 $ lrdwght : num  1.39 1.52 1.19 1.45 1.51 ...
 $ lage    : num  1.38 1.52 1.23 1.49 1.57 ...
 $ rage    : int  4 6 3 6 7 7 4 6 6 7 ...
 $ ryear   : int  1954 1954 1954 1954 1954 1954 1954 1954 1954 1954 ...
 $ ryear2  : int  1958 1958 1958 1958 1958 1958 1958 1958 1958 1958 ...
 $ ryear3  : int  1966 1966 1966 1966 1966 1966 1966 1966 1966 1966 ...
 $ location: int  1 1 1 1 1 1 1 1 1 1 ...
 $ girth   : logi  NA NA NA NA NA NA ...
 $ lgirth  : logi  NA NA NA NA NA NA ...</code></pre>
</div>
</div>
<ul>
<li>Ensuite, visualisez les donn√©es (de la m√™me mani√®re que dans le chapitre pr√©c√©dent sur les tests de t). Cr√©ez un histogramme avec une courbe de densit√© et un ‚ÄúBox plot‚Äù par ann√©e. Que vous r√©v√®lent ces donn√©es ?</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mongraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">Dam10dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fklngth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longueur √† la fourche (cm)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Densit√©"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_rug.html">geom_rug</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">dnorm</span>,</span>
<span>    args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dam10dat</span><span class="op">$</span><span class="va">fklngth</span><span class="op">)</span>,</span>
<span>      sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Dam10dat</span><span class="op">$</span><span class="va">fklngth</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Affichez le graphe, par ann√©e</span></span>
<span><span class="va">mongraph</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">year</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ano-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ano-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="33-anova_files/figure-html/fig-ano-2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ano-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.1: Distribution de la longueur des esturgeons par ann√©e.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">fklngth</span> <span class="op">~</span> <span class="va">year</span>, data <span class="op">=</span> <span class="va">Dam10dat</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"Ann√©es"</span>, ylab <span class="op">=</span> <span class="st">"Longueur √† la fourche (cm)"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-box1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-box1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="33-anova_files/figure-html/fig-box1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-box1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.2: Boxplot de la longueur √† la fourche pas ann√©ee.
</figcaption></figure>
</div>
</div>
</div>
<p>Il semble que la taille des esturgeons ait l√©g√®rement diminu√© apr√®s la construction du barrage, mais les donn√©es sont tr√®s variables et les effets ne sont pas parfaitement clairs. Il y a peut-√™tre des probl√®mes de normalit√© avec les √©chantillons de 1954 et 1966, et il y a probablement des valeurs extr√™mes dans les √©chantillons de 1958 et 1966. Testons les conditions d‚Äôapplication de l‚ÄôANOVA. Il faut d‚Äôabord faire l‚Äôanalyse et examiner les r√©sidus.</p>
</section><section id="v√©rifier-les-conditions-dapplication-de-lanova-param√©trique" class="level3" data-number="11.2.2"><h3 data-number="11.2.2" class="anchored" data-anchor-id="v√©rifier-les-conditions-dapplication-de-lanova-param√©trique">
<span class="header-section-number">11.2.2</span> V√©rifier les conditions d‚Äôapplication de l‚ÄôANOVA param√©trique</h3>
<p>L‚ÄôANOVA param√©trique a trois principales conditions d‚Äôapplication :</p>
<ol type="1">
<li>Les r√©sidus sont <strong>normalement</strong> distribu√©s,</li>
<li>La variance des r√©sidus est √©gale dans tous les traitements (<strong>homosc√©dasticit√©</strong>) et</li>
<li>Les r√©sidus sont <strong>ind√©pendants</strong> les uns des autres.</li>
</ol>
<p>Ces conditions doivent √™tre remplies avant que l‚Äôon puisse se fier aux r√©sultats de l‚ÄôANOVA param√©trique.</p>
<ul>
<li>Faites une ANOVA √† un crit√®re de classification sur la longueur (<code>fklngth</code>) par ann√©e (<code>year</code>) et produisez les graphiques diagnostiques</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ajustez le mod√®le anova et affichez les graphiques diagnostiques des r√©sidus</span></span>
<span><span class="va">anova.model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fklngth</span> <span class="op">~</span> <span class="va">year</span>, data <span class="op">=</span> <span class="va">Dam10dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">anova.model1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ano-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ano-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="33-anova_files/figure-html/fig-ano-3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ano-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.3: Conditions d‚Äôapplications de l‚ÄôANOVA.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Avertissement
</div>
</div>
<div class="callout-body-container callout-body">
<p>V√©rifiez que la variable ind√©pendant est bien un <strong>facteur</strong>. Si la variable ind√©pendante est reconnu comme du texte (<strong>character</strong>) alors vous n‚Äôobtiendrez que 3 graphiques et un message d‚Äôerreur du type:</p>
<p>`hat values (leverages) are all = 0.1</p>
<p>and there are no factor predictors; no plot no. 5`</p>
</div>
</div>
<p>D‚Äôapr√®s les graphiques, on peut douter de la normalit√© et de l‚Äôhomog√©n√©it√© des variances. Notez qu‚Äôil y a un point qui ressort vraiment avec une forte valeur r√©siduelle (cas num√©ro 59) et qui ne s‚Äôaligne pas bien avec les autres valeurs : c‚Äôest la valeur extr√™me qui avait √©t√© d√©tect√©e plus t√¥t. Ce point fera sans doute gonfler la variance r√©siduelle du groupe auquel il appartient.</p>
<p>Des tests formels nous aideront √† confirmer ou infirmer les conclusions faites √† partir de ces graphiques.</p>
<ul>
<li>Test de normalit√© sur les r√©sidus de l‚ÄôANOVA.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">anova.model1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(anova.model1)
W = 0.91571, p-value = 1.63e-06</code></pre>
</div>
</div>
<p>Ce test confirme nos soup√ßons: les r√©sidus ne sont pas distribu√©s normalement. Il faut cependant garder √† l‚Äôesprit que la puissance est grande et que m√™me de petites d√©viations de la normalit√© sont suffisantes pour rejeter l‚Äôhypoth√®se nulle.</p>
<ul>
<li>Test de l‚Äôhypoth√®se d‚Äô√©galit√© des variances (homoscedasticit√©):</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">fklngth</span> <span class="op">~</span> <span class="va">year</span>, data <span class="op">=</span> <span class="va">Dam10dat</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value  Pr(&gt;F)  
group   3  2.8159 0.04234 *
      114                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>La valeur de p vous dit que vous pouvez rejeter l‚Äôhypoth√®se nulle qu‚Äôil n‚Äôy a aucune diff√©rence dans les variances entre les ann√©es. Alors, nous concluons que les variances ne sont pas homog√®nes.</p>
</section><section id="faire-lanova" class="level3" data-number="11.2.3"><h3 data-number="11.2.3" class="anchored" data-anchor-id="faire-lanova">
<span class="header-section-number">11.2.3</span> Faire l‚ÄôANOVA</h3>
<ul>
<li>Faites une ANOVA de <code>fklnght</code> en choisissant / pr√©sumant pour l‚Äôinstant que les conditions d‚Äôapplication sont suffisamment remplies. Que concluez-vous?</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">anova.model1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = fklngth ~ year, data = Dam10dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.2116  -2.6866  -0.7116   2.2103  26.7885 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  48.0243     0.8566  56.061  &lt; 2e-16 ***
year1958      0.1872     1.3335   0.140  0.88859    
year1965     -5.5077     1.7310  -3.182  0.00189 ** 
year1966     -3.3127     1.1684  -2.835  0.00542 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.211 on 114 degrees of freedom
Multiple R-squared:  0.1355,    Adjusted R-squared:  0.1128 
F-statistic: 5.957 on 3 and 114 DF,  p-value: 0.0008246</code></pre>
</div>
</div>
<ul>
<li>
<em><code>Coefficients: Estimates</code></em>: Les 4 coefficients peuvent √™tre utilis√©s pour obtenir les valeurs pr√©dites par le mod√®le (i.e., les moyennes de chaque groupe). La longueur √† la fourche (<code>fklngth</code>) moyenne de la premi√®re ann√©e (1954) est <span class="math inline">\(48.0243\)</span>. Les coefficients pour les 3 autres ann√©es sont la diff√©rence entre la moyenne de l‚Äôann√©e en question et la moyenne de 1954. La moyenne pour 1965 est <span class="math inline">\(48.0243-5.5077=42.5166\)</span>. Pour chaque coefficient, on a √©galement acc√®s √† <strong>l‚Äôerreur-type</strong>, une <strong>valeur de t</strong> et la <strong>probabilit√© qui lui est associ√©e</strong> (pour H0 que le coefficient est 0). Les poissons √©taient plus petits apr√®s la construction du barrage qu‚Äôen 1954. Il faut n√©anmoins prendre ces p-valeurs avec un grain de sel, car elles ne sont pas corrig√©es pour les comparaisons multiples et elles ne constituent qu‚Äôun sous-ensemble des comparaisons possibles. En g√©n√©ral, je porte peu d‚Äôattention √† cette partie des r√©sultats imprim√©s et me concentre sur ce qui suit.</li>
<li>
<em><code>Residual standard error</code></em>: La racine carr√©e de la variance des r√©sidus (valeurs <em>observ√©es</em> moins valeurs <em>pr√©dites</em>) qui correspond √† la <strong>variabilit√© inexpliqu√©e par le mod√®le</strong> (variation de la taille des poissons captur√©s la m√™me ann√©e).</li>
<li>
<em><code>Mutiple R-squared</code></em>: Le R-carr√© est la proportion de la variabilit√© de la variable d√©pendante qui peut √™tre <strong>expliqu√©e par le mod√®le</strong>. Ici, le mod√®le explique <span class="math inline">\(13.5\)</span>% de la variabilit√©. Les diff√©rences de taille d‚Äôune ann√©e √† l‚Äôautre sont relativement petites lorsqu‚Äôon les compare √† la variation de taille entre les poissons captur√©s la m√™me ann√©e.</li>
<li>
<em><code>F-Statistic</code></em>: La p-valeur associ√©e au test ‚Äúomnibus‚Äù que toutes les moyennes sont √©gales. Ici, p est beaucoup plus petit que 0.05 et on rejetterait H0 pour conclure que <code>fklngth</code> varie selon les ann√©es.</li>
</ul>
<p>La fonction <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> produit le tableau d‚ÄôANOVA standard qui contient la plupart de ces informations :</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">anova.model1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: fklngth
           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
year        3  485.26 161.755  5.9574 0.0008246 ***
Residuals 114 3095.30  27.152                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>La variabilit√© totale de <code>fklngth</code>, mesur√©e par la somme du carr√© des √©carts (<code>Sum sq</code>) est partitionn√©e en ce qui peut √™tre expliqu√© par l‚Äôann√©e (<span class="math inline">\(485.26\)</span>) et la variabilit√© r√©siduelle inexpliqu√©e (<span class="math inline">\(3095.30\)</span>). L‚Äôann√©e explique bien <span class="math inline">\(\frac{485.26}{3095.30+485.26}=0.1355\)</span> or 13.55% de la variabilit√©. Le carr√© moyen des r√©sidus (<code>Residual Mean Sq</code>) correspond √† leur variance.</p>
</section><section id="les-comparaisons-multiples" class="level3" data-number="11.2.4"><h3 data-number="11.2.4" class="anchored" data-anchor-id="les-comparaisons-multiples">
<span class="header-section-number">11.2.4</span> Les comparaisons multiples</h3>
<ul>
<li>La fonction <code><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test()</a></code> peut √™tre utilis√©e pour comparer des moyennes et ajuster (ou non) les probabilit√©s pour le nombre de comparaisons en utilisant l‚Äôune des options pour l‚Äôargument <code>p.adj</code> :</li>
</ul>
<p>Comparez toutes les moyennes sans ajuster les probabilit√©s :</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">Dam10dat</span><span class="op">$</span><span class="va">fklngth</span>, <span class="va">Dam10dat</span><span class="op">$</span><span class="va">year</span>,</span>
<span>  p.adj <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  Dam10dat$fklngth and Dam10dat$year 

     1954   1958   1965  
1958 0.8886 -      -     
1965 0.0019 0.0022 -     
1966 0.0054 0.0079 0.1996

P value adjustment method: none </code></pre>
</div>
</div>
<p>L‚Äôoption <code>"bonf"</code> ajuste les p-valeurs avec la correction de Bonferroni. Ici, il y a 6 valeurs p calcul√©es, et la correction de Bonferroni revient √† simplement multiplier la p-valeur par 6 (sauf si le r√©sultat est sup√©rieur √† 1. Si tel est le cas, la ‚Äúp-value‚Äù ajust√©e est 1).</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">Dam10dat</span><span class="op">$</span><span class="va">fklngth</span>, <span class="va">Dam10dat</span><span class="op">$</span><span class="va">year</span>,</span>
<span>  p.adj <span class="op">=</span> <span class="st">"bonf"</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  Dam10dat$fklngth and Dam10dat$year 

     1954  1958  1965 
1958 1.000 -     -    
1965 0.011 0.013 -    
1966 0.033 0.047 1.000

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<p>L‚Äôoption <code>"holm"</code> correspond √† la correction s√©quentielle de Bonferroni dans laquelle les p-valeurs sont ordonn√©es de (i=1) la plus faible √† (N) la plus grande. La correction pour les p-valeurs est <span class="math inline">\(\boldsymbol{(N-i+1)}\)</span>. Ici, il y a <span class="math inline">\(N=6\)</span> paires de moyennes qui sont compar√©es. La plus petite valeur de p non corrig√©e est 0.0019 pour 1954 vs 1965. La p-valeur corrig√©e est donc <span class="math inline">\(0.0019*(6-1+1)=0.011\)</span>. La seconde plus petite p-valeur est 0.0022. Sa p-valeur corrig√©e est <span class="math inline">\(0.0022*(6-2+1)=0.011\)</span>. Pour la p-valeur la plus √©lev√©e, la correction est <span class="math inline">\((N-N+1)=1\)</span>, donc la p-valeur corrig√©e est √©gale √† la p-valeur brute.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">Dam10dat</span><span class="op">$</span><span class="va">fklngth</span>, <span class="va">Dam10dat</span><span class="op">$</span><span class="va">year</span>,</span>
<span>  p.adj <span class="op">=</span> <span class="st">"holm"</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  Dam10dat$fklngth and Dam10dat$year 

     1954  1958  1965 
1958 0.889 -     -    
1965 0.011 0.011 -    
1966 0.022 0.024 0.399

P value adjustment method: holm </code></pre>
</div>
</div>
<p>L‚Äôoption <code>"fdr"</code> sert √† contr√¥ler le ‚Äúfalse discovery rate‚Äù.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">Dam10dat</span><span class="op">$</span><span class="va">fklngth</span>, <span class="va">Dam10dat</span><span class="op">$</span><span class="va">year</span>,</span>
<span>  p.adj <span class="op">=</span> <span class="st">"fdr"</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  Dam10dat$fklngth and Dam10dat$year 

     1954   1958   1965  
1958 0.8886 -      -     
1965 0.0066 0.0066 -     
1966 0.0108 0.0119 0.2395

P value adjustment method: fdr </code></pre>
</div>
</div>
<p>Les quatre m√©thodes m√®nent ici √† la m√™me conclusion: les poissons sont plus gros apr√®s la construction du barrage et toutes les comparaisons entre les ann√©es 50 et 60 sont significatives alors que les diff√©rences entre 54 et 58 ou 65 et 66 ne le sont pas. La conclusion ne d√©pend pas du choix de m√©thode.</p>
<p>Dans d‚Äôautres situations, vous pourriez obtenir des r√©sultats contradictoires. Alors, quelle m√©thode choisir ? Les p-valeurs qui ne sont pas corrig√©es sont certainement suspectes lorsqu‚Äôil y a plusieurs comparaisons. D‚Äôun autre cot√©, la correction de <em>Bonferroni</em> est conservatrice et le devient encore plus lorsqu‚Äôil y a de tr√®s nombreuses comparaisons. Des travaux r√©cents sugg√®rent que la correction <strong>fdr</strong> est un bon compromis lorsqu‚Äôil y a beaucoup de comparaisons.</p>
<p>La m√©thode de <em>Tukey</em> est l‚Äôune des plus populaires et est facile √† utiliser en R (notez cependant qu‚Äôil y a un petit bug qui se manifeste quand la variable ind√©pendante peut ressembler √† un nombre plut√¥t qu‚Äôun facteur, ce qui explique la petite pirouette avec <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> dans le code pour ajouter la lettre <code>m</code> avant le premier chiffre):</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Dam10dat</span><span class="op">$</span><span class="va">myyear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="va">Dam10dat</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">fklngth</span> <span class="op">~</span> <span class="va">myyear</span>, data <span class="op">=</span> <span class="va">Dam10dat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = fklngth ~ myyear, data = Dam10dat)

$myyear
                  diff        lwr        upr     p adj
m1958-m1954  0.1872141  -3.289570  3.6639986 0.9990071
m1965-m1954 -5.5076577 -10.021034 -0.9942809 0.0100528
m1966-m1954 -3.3126964  -6.359223 -0.2661701 0.0274077
m1965-m1958 -5.6948718 -10.436304 -0.9534397 0.0116943
m1966-m1958 -3.4999106  -6.875104 -0.1247171 0.0390011
m1966-m1965  2.1949612  -2.240630  6.6305526 0.5710111</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">fklngth</span> <span class="op">~</span> <span class="va">myyear</span>, data <span class="op">=</span> <span class="va">Dam10dat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ano-13" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ano-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="33-anova_files/figure-html/fig-ano-13-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ano-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.4: Diff√©rence anuelles dans la longueur des esturgeons.
</figcaption></figure>
</div>
</div>
</div>
<p>Les intervalles de confiance, corrig√©s pour les comparaisons multiples par la m√©thode de Tukey, sont illustr√©s pour les diff√©rences entre ann√©es. Malheureusement les l√©gendes ne sont pas compl√®tes, mais l‚Äôordre est le m√™me que dans le tableau pr√©c√©dent.</p>
<p>Le paquet <code>multcomp</code> <span class="emoji" data-emoji="package">üì¶</span> peut produire de meilleurs graphiques, mais requiert un peu plus de code:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Autre mani√®re de faire une comparaison multiple corrig√©e par la m√©thode de Tukey</span></span>
<span><span class="co"># Ajustez une ANOVA √† un crit√®re de classification</span></span>
<span><span class="va">anova.fkl.vs.year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">fklngth</span> <span class="op">~</span> <span class="va">myyear</span>, data <span class="op">=</span> <span class="va">Dam10dat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># √âtablissez des comparaisons par paires pour le facteur `year`</span></span>
<span></span>
<span><span class="va">meandiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht</a></span><span class="op">(</span><span class="va">anova.fkl.vs.year</span>, linfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">mcp</a></span><span class="op">(</span></span>
<span>  myyear <span class="op">=</span></span>
<span>    <span class="st">"Tukey"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">meandiff</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Confidence Intervals

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = aov(fklngth ~ myyear, data = Dam10dat))

Quantile = 2.5934
95% family-wise confidence level
 

Linear Hypotheses:
                   Estimate lwr      upr     
m1958 - m1954 == 0   0.1872  -3.2710   3.6454
m1965 - m1954 == 0  -5.5077  -9.9969  -1.0184
m1966 - m1954 == 0  -3.3127  -6.3429  -0.2825
m1965 - m1958 == 0  -5.6949 -10.4109  -0.9788
m1966 - m1958 == 0  -3.4999  -6.8571  -0.1428
m1966 - m1965 == 0   2.1950  -2.2169   6.6068</code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">meandiff</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ano-14" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ano-14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="33-anova_files/figure-html/fig-ano-14-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ano-14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.5: Diff√©rence anuelles dans la longueur des esturgeons (avec <code>multcomp</code> <span class="emoji" data-emoji="package">üì¶</span>).
</figcaption></figure>
</div>
</div>
</div>
<p>C‚Äôest un peu mieux, mais ce qui le serait encore plus c‚Äôest un graphique des moyennes, avec leurs intervalles de confiance ajust√©s pour les comparaisons multiples:</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculez et repr√©sentez les moyennes et l'IC de Tukey</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht</a></span><span class="op">(</span></span>
<span>  <span class="va">anova.fkl.vs.year</span>,</span>
<span>  linfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">mcp</a></span><span class="op">(</span>myyear <span class="op">=</span> <span class="st">"Tukey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">cimeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/cld.html">cld</a></span><span class="op">(</span><span class="va">means</span><span class="op">)</span></span>
<span><span class="co"># Utilisez une marge sup√©rieure suffisamment grande</span></span>
<span><span class="co"># Graphique</span></span>
<span><span class="va">old.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1.25</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cimeans</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ano-15" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ano-15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="33-anova_files/figure-html/fig-ano-15-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ano-15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.6: Diff√©rence anuelles dans la longueur des esturgeons.
</figcaption></figure>
</div>
</div>
</div>
<p>Notez les lettres au dessus du graphique: les ann√©es √©tiquet√©es avec la m√™me lettre ne diff√®rent pas significativement l‚Äôune de l‚Äôautre.</p>
</section></section><section id="transformations-de-donn√©es-et-anova-non-param√©trique" class="level2" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="transformations-de-donn√©es-et-anova-non-param√©trique">
<span class="header-section-number">11.3</span> Transformations de donn√©es et ANOVA non-param√©trique</h2>
<p>Dans l‚Äôexemple pr√©c√©dent sur les diff√©rences annuelles de longueur (variable <code>fklgnth</code>), on a not√© que les conditions d‚Äôapplication de l‚ÄôANOVA n‚Äô√©taient pas remplies. Si les donn√©es ne remplissent pas les conditions de l‚ÄôANOVA param√©trique, il y a 3 options :</p>
<ol type="1">
<li>Ne rien faire. Si les effectifs dans chaque groupe sont grands, on peut relaxer les conditions d‚Äôapplication car l‚ÄôANOVA est alors assez robuste aux violations de normalit√© (mais moins aux violations d‚Äôhomoscedasticit√©),</li>
<li>Transformer les donn√©es</li>
<li>Faire une analyse non-param√©trique.</li>
</ol>
<ul>
<li>Refaites l‚ÄôANOVA de la section pr√©c√©dente apr√®s avoir transform√© <code>fglngth</code> en logarithme de base 10. Avec les donn√©es transform√©es, est-ce que les probl√®mes qui avaient √©t√© identifi√©s disparaissent ?</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ajustez un mod√®le anova avec une transformation log10 de `fklngth`et tracez les graphiques diagnostiques</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">anova.model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fklngth</span><span class="op">)</span> <span class="op">~</span> <span class="va">year</span>, data <span class="op">=</span> <span class="va">Dam10dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">anova.model2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ano-16" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ano-16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="33-anova_files/figure-html/fig-ano-16-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ano-16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.7: Conditions d‚Äôapplication de l‚ÄôANOVA.
</figcaption></figure>
</div>
</div>
</div>
<p>Les graphiques sont √† peine mieux ici. Si on fait le test Shapiro-Wilk sur les r√©sidus, on obtient:</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">anova.model2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(anova.model2)
W = 0.96199, p-value = 0.002048</code></pre>
</div>
</div>
<p>Donc, on a toujours des probl√®mes avec la normalit√© et on est juste sur le seuil de d√©cision pour l‚Äô√©galit√© des variances. Vous avez le choix √† ce point:</p>
<ol type="1">
<li>Essayer de trouver une autre transformation pour mieux rencontrer les conditions d‚Äôapplication.</li>
<li>Assumer que les donn√©es sont suffisamment proche des conditions d‚Äôapplication.</li>
<li>Faire une ANOVA non-param√©trique.</li>
</ol>
<ul>
<li>L‚Äôanalogue non-param√©trique de l‚ÄôANOVA √† un crit√®re de classification le plus employ√© est le test de <strong>Kruskall-Wallis</strong>. Faites ce test sur <code>fklngth</code> et comparez les r√©sultats √† ceux de l‚Äôanalyse param√©trique. Que concluez-vous?</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">fklngth</span> <span class="op">~</span> <span class="va">year</span>, data <span class="op">=</span> <span class="va">Dam10dat</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  fklngth by year
Kruskal-Wallis chi-squared = 15.731, df = 3, p-value = 0.001288</code></pre>
</div>
</div>
<p>La conclusion est donc la m√™me qu‚Äôavec l‚ÄôANOVA param√©trique: on rejette l‚Äôhypoth√®se nulle que le rang moyen est le m√™me pour chaque ann√©e. Donc, m√™me si les conditions d‚Äôapplication de l‚Äôanalyse param√©trique n‚Äô√©taient pas parfaitement rencontr√©es, les conclusions sont les m√™mes, ce qui illustre la robustesse de l‚ÄôANOVA param√©trique.</p>
</section><section id="examen-des-valeurs-extr√™mes" class="level2" data-number="11.4"><h2 data-number="11.4" class="anchored" data-anchor-id="examen-des-valeurs-extr√™mes">
<span class="header-section-number">11.4</span> Examen des valeurs extr√™mes</h2>
<p>Vous devriez avoir remarqu√© au cours des analyses pr√©c√©dentes qu‚Äôil y avait peut-√™tre des valeurs extr√™mes dans les donn√©es. Ces points √©taient √©vidents dans le ‚ÄúBox Plot‚Äù de <code>fklngth</code> par <code>year</code> et ont √©t√© not√©s comme les points 59, 23, et 87 dans les diagrammes de probabilit√© des r√©sidus et dans le diagramme de dispersion des r√©sidus et des valeurs estim√©es. En g√©n√©ral, vous devez avoir de tr√®s bonnes raisons pour enlever des valeurs extr√™mes de la base de donn√©es (i.e.&nbsp;vous savez qu‚Äôil y a eu une erreur avec un cas). Cependant, il est quand m√™me toujours valable de voir comment l‚Äôanalyse change en enlevant des valeurs extr√™mes de la base de donn√©es.</p>
<ul>
<li>R√©p√©tez l‚ÄôANOVA originale sur <code>fklngth</code> et <code>year</code> mais faites le avec un sous-ensemble de donn√©es sans les valeurs extr√™mes. Est-ce que les conclusions ont chang√©?</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Damsubset</span> <span class="op">&lt;-</span> <span class="va">Dam10dat</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">23</span>, <span class="fl">59</span>, <span class="fl">87</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># enlevez les observations 23, 59 et 87</span></span>
<span><span class="va">aov.Damsubset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">fklngth</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>, <span class="va">Damsubset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov.Damsubset</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Df Sum Sq Mean Sq F value   Pr(&gt;F)    
as.factor(year)   3  367.5  122.50   6.894 0.000267 ***
Residuals       111 1972.4   17.77                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">aov.Damsubset</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(aov.Damsubset)
W = 0.98533, p-value = 0.2448</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span><span class="va">fklngth</span> <span class="op">~</span> <span class="va">year</span>, <span class="va">Damsubset</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
       Df F value   Pr(&gt;F)   
group   3  4.6237 0.004367 **
      111                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>L‚Äô√©limination de trois valeurs extr√™mes am√©liore un peu les choses, mais ce n‚Äôest pas parfait. On a toujours un probl√®me avec les variances, mais les r√©sidus sont maintenant normaux. Cependant, le fait que la conclusion qu‚Äôon tire de l‚ÄôANOVA originale ne change pas en enlevant les points renforce le fait qu‚Äôon n‚Äôa pas de raison valable pour enlever ces points.</p>
</section><section id="test-de-permutation" class="level2" data-number="11.5"><h2 data-number="11.5" class="anchored" data-anchor-id="test-de-permutation">
<span class="header-section-number">11.5</span> Test de permutation</h2>
<p>Commande R pour un test de permutation d‚Äôune ANOVA √† un crit√®re de classification.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#############################################################</span></span>
<span><span class="co"># Test de permutation pour ANOVA √† un crit√®re de classification</span></span>
<span><span class="co"># modifi√© √† partir du code √©crit par David C. Howell</span></span>
<span><span class="co"># http://www.uvm.edu/~dhowell/StatPages/More_Stuff/Permutation%20Anova/PermTestsAnova.html</span></span>
<span><span class="co"># D√©finition du nombre de permutation</span></span>
<span><span class="va">nreps</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="co"># Pour simplifier la r√©utilisation de ce code, assignez le jeu de donn√©e √† utiliser √† l'objet "mydata"</span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="va">Dam10dat</span></span>
<span><span class="co"># Stockez la formule de votre mod√®le dans l'objet myformula</span></span>
<span><span class="va">myformula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"fklngth ~ year"</span><span class="op">)</span></span>
<span><span class="co"># Stockez la variable d√©pendante dans l'objet mydep</span></span>
<span><span class="va">mydep</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">$</span><span class="va">fklngth</span></span>
<span><span class="co"># Stockez la variable ind√©pendante dans l'objet myindep</span></span>
<span><span class="va">myindep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span><span class="co">################################################</span></span>
<span></span>
<span><span class="co"># Vous ne devriez pas avoir besoin de modifier le code ci-dessous</span></span>
<span></span>
<span><span class="co">################################################</span></span>
<span><span class="co"># Calculez la valeur F observ√©e pour l'√©chantillon original</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">myformula</span>, data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span> <span class="co"># Anova Standard</span></span>
<span><span class="va">ANOVA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">)</span> <span class="co"># Stockez le r√©sum√© dans une variable</span></span>
<span><span class="va">observedF</span> <span class="op">&lt;-</span> <span class="va">ANOVA</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="st">"F value"</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># Stockez la valeur F observ√©e</span></span>
<span><span class="co"># Affichez les r√©sultats de l'ANOVA standard</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">" L'ANOVA standard pour ces donn√©es est la suivante "</span>,</span>
<span>  <span class="st">"\n"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ANOVA</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"R√©√©chantillonnage comme dans Manly avec √©chantillonnage non restreint des observations. "</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Commen√ßons le r√©√©chantillonnage</span></span>
<span><span class="va">Fboot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">nreps</span><span class="op">)</span> <span class="co"># initialisez le vecteur pour qu'il soit permut√©</span></span>
<span><span class="va">values</span></span>
<span><span class="va">Fboot</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">observedF</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">nreps</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">newdependent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">mydep</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mydep</span><span class="op">)</span><span class="op">)</span> <span class="co"># Randomiser la variable d√©pendante</span></span>
<span>  <span class="va">var</span></span>
<span>  <span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">newdependent</span> <span class="op">~</span> <span class="va">myindep</span><span class="op">)</span> <span class="co"># R√©ajuste le mod√®le</span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">Fboot</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="st">"F value"</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># Stock la statistique F</span></span>
<span><span class="op">}</span></span>
<span><span class="va">permprob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Fboot</span><span class="op">[</span><span class="va">Fboot</span> <span class="op">&gt;=</span> <span class="va">observedF</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">nreps</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">" The permutation probability value is: "</span>, <span class="va">permprob</span>,</span>
<span>  <span class="st">"\n"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Fin du bloc de code de permutation.</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Version lmPerm du test de permutation :</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Version lmPerm du test de permutation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mtorchiano/lmPerm">lmPerm</a></span><span class="op">)</span></span>
<span><span class="co"># Pour g√©n√©raliser, assignez votre jeu de donn√©e √† l'objet mydata</span></span>
<span><span class="co"># et la formule du mod√®le √† myformula</span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="va">Dam10dat</span></span>
<span><span class="va">myformula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"fklngth ~ year"</span><span class="op">)</span></span>
<span><span class="co"># Ajustez le mod√®le souhait√© sur le jeu de donn√©e souhait√©</span></span>
<span><span class="va">mymodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">myformula</span>, data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co"># Calcule de la valeur p permut√©</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lmPerm/man/lmp.html">lmp</a></span><span class="op">(</span><span class="va">myformula</span>, data <span class="op">=</span> <span class="va">mydata</span>, perm <span class="op">=</span> <span class="st">"Prob"</span>, center <span class="op">=</span> <span class="cn">FALSE</span>, Ca <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copi√©");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copi√©");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/biostats-uottawa\.github\.io\/enfR\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./32-t_test.html" class="pagination-link" aria-label="Comparaison de deux √©chantillons">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Comparaison de deux √©chantillons</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./34-anova_mult.html" class="pagination-link" aria-label="ANOVA √† crit√®res multiples : plans factoriels et hi√©rarchiques">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">ANOVA √† crit√®res multiples : plans factoriels et hi√©rarchiques</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://biostats-uottawa.github.io/people.html">Julien Martin</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/biostats-uottawa/enfR/edit/main/33-anova.qmd" class="toc-action"><i class="bi bi-github"></i>Modifier cette page</a></li><li><a href="https://github.com/biostats-uottawa/enfR/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un probl√®me</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Ce livre a √©t√© cr√©e avec <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>
