<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr-fr" xml:lang="fr-fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.18">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Julien Martin">
<meta name="description" content="En cours de traduction">
<title>9&nbsp; Corr√©lation et r√©gression lin√©aire simple ‚Äì Sur le chemin de l'enf-R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./32-t_test.html" rel="next">
<link href="./25-puissance.html" rel="prev">
<link href="./images/cover/book_fav.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-018089954d508eae8a473f0b7f0491f0.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-5223d57514b7f3c9e8f675d86406bf62.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4ee51bf3f97b95f0ac1d3b797e87ffb6.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de r√©sultats",
    "search-matching-documents-text": "documents trouv√©s",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SLXFYRXJR4"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SLXFYRXJR4', { 'anonymize_ip': true});
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><img src="images/cover/book_hex_fr.png" class="img-fluid" width="50"> Chemin enf-R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Recherche"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-flag" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-flag" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bi-flag">
<li>
    <a class="dropdown-item" href="https://biostats-uottawa.github.io/Rway/31-reg_lin.html">
 <span class="dropdown-text">English</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link active" href="./902-donnees.html" aria-current="page"> 
<span class="menu-text">Donn√©es</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/"> 
<span class="menu-text">Biostats uOttawa</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/bioXx58/"> 
<span class="menu-text">Biostats with R (BioXx58)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/bio8940/"> 
<span class="menu-text">Biostats avanc√©es et science ouverte (Bio8940)</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/biostats-uottawa/enfR/" title="Code source" class="quarto-navigation-tool px-1" aria-label="Code source"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="T√©l√©charger" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="T√©l√©charger"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./Sur-le-chemin-de-l-enf-R.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            T√©l√©charger PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./Sur-le-chemin-de-l-enf-R.epub">
              <i class="bi bi-journal pe-1"></i>
            T√©l√©charger ePub
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Basculer le mode sombre"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Basculer en mode lecteur">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre lat√©rale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./31-reg_lin.html">Mod√®les lin√©aires</a></li><li class="breadcrumb-item"><a href="./31-reg_lin.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Corr√©lation et r√©gression lin√©aire simple</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre lat√©rale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pr√©face</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Utiliser R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-debut.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Pour commencer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-base.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Quelques notions de base sur R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-donnees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Donn√©es</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-graphique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Figures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-programmation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Programmation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Rapports reproductibles avec Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Contr√¥le de version avec Git et GitHub</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Principes de statistique</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-puissance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Analyse de puissance avec R et G\*Power</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Mod√®les lin√©aires</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31-reg_lin.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Corr√©lation et r√©gression lin√©aire simple</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32-t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Comparaison de deux √©chantillons</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ANOVA √† un crit√®re de classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34-anova_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">ANOVA √† crit√®res multiples : plans factoriels et hi√©rarchiques</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./35-reg_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">R√©gression multiple</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./36-ancova_glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">ANCOVA et mod√®le lin√©aire g√©n√©ral</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Mod√®les lin√©aires g√©n√©ralis√©s</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./42-model_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Analyse de donn√©es de fr√©quence: Tableaux de contingence, mod√®les log-lin√©aires et r√©gression de Poisson</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Mod√®les mixtes</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Mod√®les additifs g√©n√©ralis√©s</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Analyses multivari√©es</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Approche Bayesienne</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./901-bibliographie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R√©f√©rences</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Annexes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./902-donnees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Donn√©es utilis√©es dans le livre</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table des mati√®res</h2>
   
  <ul>
<li><a href="#set-lm" id="toc-set-lm" class="nav-link active" data-scroll-target="#set-lm"><span class="header-section-number">9.1</span> Paquets R et donn√©es requises</a></li>
  <li><a href="#diagrammes-de-dispersion" id="toc-diagrammes-de-dispersion" class="nav-link" data-scroll-target="#diagrammes-de-dispersion"><span class="header-section-number">9.2</span> Diagrammes de dispersion</a></li>
  <li><a href="#transformations-de-donn%C3%A9es-et-coefficient-de-corr%C3%A9lation" id="toc-transformations-de-donn√©es-et-coefficient-de-corr√©lation" class="nav-link" data-scroll-target="#transformations-de-donn%C3%A9es-et-coefficient-de-corr%C3%A9lation"><span class="header-section-number">9.3</span> Transformations de donn√©es et coefficient de corr√©lation</a></li>
  <li><a href="#matrices-de-corr%C3%A9lations-et-correction-de-bonferroni" id="toc-matrices-de-corr√©lations-et-correction-de-bonferroni" class="nav-link" data-scroll-target="#matrices-de-corr%C3%A9lations-et-correction-de-bonferroni"><span class="header-section-number">9.4</span> Matrices de corr√©lations et correction de Bonferroni</a></li>
  <li><a href="#corr%C3%A9lations-non-param%C3%A9triques-r-de-spearman-et-tau-de-kendall" id="toc-corr√©lations-non-param√©triques-r-de-spearman-et-tau-de-kendall" class="nav-link" data-scroll-target="#corr%C3%A9lations-non-param%C3%A9triques-r-de-spearman-et-tau-de-kendall"><span class="header-section-number">9.5</span> Corr√©lations non param√©triques: <em>r</em> de Spearman et <span class="math inline">\(\tau\)</span> de Kendall</a></li>
  <li>
<a href="#sec-simple-lm" id="toc-sec-simple-lm" class="nav-link" data-scroll-target="#sec-simple-lm"><span class="header-section-number">9.6</span> R√©gression lin√©aire simple</a>
  <ul class="collapse">
<li><a href="#sec-cond-verif" id="toc-sec-cond-verif" class="nav-link" data-scroll-target="#sec-cond-verif"><span class="header-section-number">9.6.1</span> V√©rifier les conditions d‚Äôapplication de la r√©gression</a></li>
  <li><a href="#tests-formels-des-conditions-dapplication-pour-la-r%C3%A9gression" id="toc-tests-formels-des-conditions-dapplication-pour-la-r√©gression" class="nav-link" data-scroll-target="#tests-formels-des-conditions-dapplication-pour-la-r%C3%A9gression"><span class="header-section-number">9.6.2</span> Tests formels des conditions d‚Äôapplication pour la r√©gression</a></li>
  </ul>
</li>
  <li><a href="#transformation-des-donn%C3%A9es-en-r%C3%A9gression" id="toc-transformation-des-donn√©es-en-r√©gression" class="nav-link" data-scroll-target="#transformation-des-donn%C3%A9es-en-r%C3%A9gression"><span class="header-section-number">9.7</span> Transformation des donn√©es en r√©gression</a></li>
  <li><a href="#traitement-des-valeurs-extr%C3%AAmes" id="toc-traitement-des-valeurs-extr√™mes" class="nav-link" data-scroll-target="#traitement-des-valeurs-extr%C3%AAmes"><span class="header-section-number">9.8</span> Traitement des valeurs extr√™mes</a></li>
  <li>
<a href="#quantifier-la-taille-deffet-et-analyse-de-puissance-en-r%C3%A9gression" id="toc-quantifier-la-taille-deffet-et-analyse-de-puissance-en-r√©gression" class="nav-link" data-scroll-target="#quantifier-la-taille-deffet-et-analyse-de-puissance-en-r%C3%A9gression"><span class="header-section-number">9.9</span> Quantifier la taille d‚Äôeffet et analyse de puissance en r√©gression</a>
  <ul class="collapse">
<li><a href="#puissance-de-d%C3%A9tecter-une-pente-donn%C3%A9e" id="toc-puissance-de-d√©tecter-une-pente-donn√©e" class="nav-link" data-scroll-target="#puissance-de-d%C3%A9tecter-une-pente-donn%C3%A9e"><span class="header-section-number">9.9.1</span> Puissance de d√©tecter une pente donn√©e</a></li>
  <li><a href="#effectif-requis-pour-atteindre-une-puissance-d%C3%A9sir%C3%A9e-test-a-priori" id="toc-effectif-requis-pour-atteindre-une-puissance-d√©sir√©e-test-a-priori" class="nav-link" data-scroll-target="#effectif-requis-pour-atteindre-une-puissance-d%C3%A9sir%C3%A9e-test-a-priori"><span class="header-section-number">9.9.2</span> Effectif requis pour atteindre une puissance d√©sir√©e (test A-priori)</a></li>
  </ul>
</li>
  <li><a href="#bootstrap-en-r%C3%A9gression-simple-avec-r" id="toc-bootstrap-en-r√©gression-simple-avec-r" class="nav-link" data-scroll-target="#bootstrap-en-r%C3%A9gression-simple-avec-r"><span class="header-section-number">9.10</span> Bootstrap en r√©gression simple avec R</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/biostats-uottawa/enfR/edit/main/31-reg_lin.qmd" class="toc-action"><i class="bi bi-github"></i>Modifier cette page</a></li><li><a href="https://github.com/biostats-uottawa/enfR/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un probl√®me</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./31-reg_lin.html">Mod√®les lin√©aires</a></li><li class="breadcrumb-item"><a href="./31-reg_lin.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Corr√©lation et r√©gression lin√©aire simple</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Corr√©lation et r√©gression lin√©aire simple</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!--course website Links--><!--cran Links--><!--RStudio--><!--style guides--><!--Package Links--><!--Editors--><!--Bioconductor Links--><!--GitHub Links--><!--R markdown Links--><!--ggplot Links--><!--Basics links--><!--Data links--><!--Resource Links--><!--Misc Links--><!--Add by Augustin--><p>Objectifs de ce chapitre :</p>
<ul>
<li>Utiliser R pour produire un diagramme de dispersion de la relation entre deux variables.</li>
<li>Utiliser R pour faire des transformations simples de donn√©es.</li>
<li>Utiliser R pour calculer le coefficient de corr√©lation de <em>Pearson</em> entre deux variables et √©valuer sa significativit√© statistique.</li>
<li>Utiliser R pour calculer la corr√©lation entre des paires de variables avec le <em>r de Spearman</em> et le <em>tau (</em><span class="math inline">\(\tau\)</span>) de Kendall</li>
<li>Utiliser R pour √©valuer la significativit√© d‚Äôune comparaison par paires √† partir d‚Äôune matrice de corr√©lation g√©n√©ralis√© en utilisant les probabilit√©s ajust√©es par la <em>m√©thode de Bonferroni</em>.</li>
<li>Utiliser R pour faire une r√©gression lin√©aire simple.</li>
<li>Utiliser R pour √©valuer si un ensemble de donn√©es remplit les conditions d‚Äôapplication d‚Äôune analyse de r√©gression simple.</li>
<li>Quantifier la taille d‚Äôeffet d‚Äôune r√©gression simple et effectuer une analyse de puissance avec G*Power.</li>
</ul>
<section id="set-lm" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="set-lm">
<span class="header-section-number">9.1</span> Paquets R et donn√©es requises</h2>
<p>Pour ce laboratoire vous aurez besoin de :</p>
<ul>
<li>paquets R :
<ul>
<li>
<code>car</code> <span class="emoji" data-emoji="package">üì¶</span>
</li>
<li>
<code>lmtest</code> <span class="emoji" data-emoji="package">üì¶</span>
</li>
<li>
<code>boot</code> <span class="emoji" data-emoji="package">üì¶</span>
</li>
<li>
<code>pwr</code> <span class="emoji" data-emoji="package">üì¶</span>
</li>
<li>
<code>ggplot</code> <span class="emoji" data-emoji="package">üì¶</span>
</li>
</ul>
</li>
<li>Jeu de donn√©es :
<ul>
<li>‚Äústurgeon.csv‚Äù</li>
</ul>
</li>
</ul>
<p>Il ne faut pas oublier de charge les paquets avec <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> (et de les installer au besoin avec <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code>). Pour les donn√©es, il faut les charger et les assigner √† un objet R avec la fonction <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr">pwr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">esturgeon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/sturgeon.csv"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notez que la ligne de code pour charger les donn√©es consid√®re que le fichier de donn√©es se trouve dans un dossier <code>data</code> au sein de votre r√©pertoire de travail. Si ce n‚Äôest pas le cas veuillez ajuster la ligne de commande selon votre r√©pertoire de travail.</p>
</div>
</div>
</section><section id="diagrammes-de-dispersion" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="diagrammes-de-dispersion">
<span class="header-section-number">9.2</span> Diagrammes de dispersion</h2>
<p>Les analyses de corr√©lation et de r√©gression devraient toujours commencer par un examen des donn√©es; c‚Äôest une √©tape critique qui sert √† √©valuer si ce type d‚Äôanalyse est appropri√© pour un ensemble de donn√©es. Supposons que nous voulons √©valuer si la longueur d‚Äôesturgeons m√¢les dans la r√©gion de <em>The Pas</em> covarie avec leur poids. Pour r√©pondre √† cette question, regardons d‚Äôabord la corr√©lation entre la longueur et le poids. Souvenez-vous qu‚Äôune des conditions d‚Äôapplication de l‚Äôanalyse de corr√©lation est que la relation entre les deux variables est lin√©aire. Pour √©valuer cela, commen√ßons par faire un diagramme de dispersion.</p>
<ul>
<li>Les donn√©es sur les esturgeons son disponibles dans le fichier <code>sturgeon.csv</code>. Apr√®s avoir charg√© les donn√©es en les assignant √† un objet <code>esturgeon</code>, faites un diagramme de dispersion avec une droite de r√©gression lin√©aire et une courbe de <a href="https://en.wikipedia.org/wiki/Local_regression">Lowess</a> de la longueur en fonction du poids.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">esturgeon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/sturgeon.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   186 obs. of  9 variables:
 $ fklngth : num  37 50.2 28.9 50.2 45.6 ...
 $ totlngth: num  40.7 54.1 31.3 53.1 49.5 ...
 $ drlngth : num  23.6 31.5 17.3 32.3 32.1 ...
 $ rdwght  : num  15.95 NA 6.49 NA 29.92 ...
 $ age     : int  11 24 7 23 20 23 20 7 23 19 ...
 $ girth   : num  40.5 53.5 31 52.5 50 54.2 48 28.5 44 39 ...
 $ sex     : chr  "MALE" "FEMALE" "MALE" "FEMALE" ...
 $ location: chr  "THE_PAS" "THE_PAS" "THE_PAS" "THE_PAS" ...
 $ year    : int  1978 1978 1978 1978 1978 1978 1978 1978 1978 1978 ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mongraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">esturgeon</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">$</span><span class="va">rdwght</span><span class="op">)</span>, <span class="op">]</span>, <span class="co"># origine des donn√©es</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fklngth</span>, y <span class="op">=</span> <span class="va">rdwght</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Repr√©sentez les donn√©es sous forme de Points, R√©gression lin√©aire, "Lowess"</span></span>
<span><span class="va">mongraph</span> <span class="op">&lt;-</span> <span class="va">mongraph</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Ajoutez une r√©gression lin√©aire, mais sans l'erreur-type (en vert)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Ajoutez la "lowess" (en rouge)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Ajoutez les donn√©es sous forme de points</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longueur"</span>, y <span class="op">=</span> <span class="st">"Poids"</span><span class="op">)</span> <span class="co"># Modifiez les noms des axes pour rendre le graphique plus lisible</span></span>
<span></span>
<span><span class="va">mongraph</span> <span class="co"># Affichez le graphique</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-stur-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-stur-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-stur-2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stur-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.1: Graphique du poids en fonction de la longueur des esturgeons.
</figcaption></figure>
</div>
</div>
</div>
<!-- (notez ici la gymnastique requise pour √©liminer les donn√©es
manquantes qui posent probl√®me pour obtenir la trace loess). -->
<!-- JULIEN - Extra - J'ai modifi√© les noms des axes pour que ce soit plus lisible. -->
<ul>
<li>Est-ce que la dispersion des points sugg√®re une bonne corr√©lation entre les deux variables? Est-ce que la relation semble lin√©aire?</li>
</ul>
<p>Ce graphique sugg√®re une tendance plus curvilin√©aire que lin√©aire. Malgr√© tout, il semble y avoir une forte corr√©lation entre les deux variables.</p>
<ul>
<li>Refaites le diagramme de dispersion avec des transformations logarithmiques sur les deux axes.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Appliquez une transformation log sur le graphique d√©j√† d√©fini</span></span>
<span><span class="va">mongraph</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-stur-log" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-stur-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-stur-log-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stur-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.2: Graphique poids-longueur avec une √©chelle log.
</figcaption></figure>
</div>
</div>
</div>
<p>Comparez les diagrammes de dispersion avant et apr√®s transformation (<a href="#fig-stur-2" class="quarto-xref">Figure&nbsp;<span>9.1</span></a> et <a href="#fig-stur-log" class="quarto-xref">Figure&nbsp;<span>9.2</span></a>). Sachant que l‚Äôanalyse de corr√©lation pr√©suppose une relation lin√©aire entre les variables, on devrait donc privil√©gier l‚Äôanalyse sur les donn√©es log-transform√©es.</p>
</section><section id="transformations-de-donn√©es-et-coefficient-de-corr√©lation" class="level2" data-number="9.3"><h2 data-number="9.3" class="anchored" data-anchor-id="transformations-de-donn√©es-et-coefficient-de-corr√©lation">
<span class="header-section-number">9.3</span> Transformations de donn√©es et coefficient de corr√©lation</h2>
<p>Une autre condition pr√©alable √† l‚Äôanalyse de corr√©lation est que les deux variables concern√©es suivent une distribution normale bivari√©e. On peut ais√©ment v√©rifier la normalit√© de chacune des 2 variables s√©par√©ment tel que d√©crit dans plus bas dans la section <a href="#sec-cond-verif" class="quarto-xref"><span>Section 9.6.1</span></a>. Si les deux variables sont normalement distribu√©es, on pr√©sume g√©n√©ralement que la distribution commune des deux variables est √©galement normale (notez que ce n‚Äôest pas toujours le cas cependant).</p>
<ul>
<li>Examinez la distribution des quatre variables (les deux variables originales et les variables transform√©es). Que concluez-vous de l‚Äôinspection visuelle de ces graphiques ?</li>
</ul>
<p>Les figures ci-dessous sont les 4 diagrammes Q(uantile)-Q(uantile) (<code><a href="https://rdrr.io/r/stats/qqnorm.html">qqplot()</a></code>). Le code pour produire des graphiques multiples sur une seule page avec 2 lignes et 2 colonnes, comme on voit ci-dessous, est :</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># divise le graphique en 4 sections</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">$</span><span class="va">fklngth</span>, ylab <span class="op">=</span> <span class="st">"fklngth"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">$</span><span class="va">fklngth</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">$</span><span class="va">fklngth</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"log10(fklngth)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">$</span><span class="va">fklngth</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">$</span><span class="va">rdwght</span>, ylab <span class="op">=</span> <span class="st">"rdwght"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">$</span><span class="va">rdwght</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">$</span><span class="va">rdwght</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"log10(rdwgth)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">$</span><span class="va">rdwght</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># red√©finie la zone de graphique par d√©faut</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-stur-4hist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-stur-4hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-stur-4hist-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stur-4hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.3: Diagrammes Q-Q des quatres variables √©tudi√©es (Poids, Longueur, Originale et Log-transform√©es).
</figcaption></figure>
</div>
</div>
</div>
<!-- JULIEN - Extra - J'ai ajout√© un titre √† la figure -->
<p>Il n‚Äôy a pas grand-chose √† redire: aucune des distributions n‚Äôest parfaitement normale, mais les d√©viations semblent mineures.</p>
<ul>
<li>G√©n√©rez une matrice de graphiques de dispersion de toutes les paires de variables (avec r√©gression lin√©aires et ‚Äúlowess‚Äù) en utilisant la fonction <code>scatterplotMatrix</code> du paquet <code>car</code> <span class="emoji" data-emoji="package">üì¶</span>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/scatterplotMatrix.html">scatterplotMatrix</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span> <span class="va">fklngth</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fklngth</span><span class="op">)</span> <span class="op">+</span> <span class="va">rdwght</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">rdwght</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">esturgeon</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">TRUE</span>, diagonal <span class="op">=</span> <span class="st">"density"</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-stur-scatmat" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-stur-scatmat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-stur-scatmat-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stur-scatmat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.4: Corr√©lations entre chaque paires de variables
</figcaption></figure>
</div>
</div>
</div>
<!-- JULIEN - Extra - J'ai ajout√© un titre √† la figure -->
<ul>
<li>Ensuite, calculez le coefficient de corr√©lation de Pearson entre chaque paire (variables originales et log-transform√©es) en utilisant la fonction <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code>. Avant de commencer, on va cependant ajouter les variables transform√©es au jeu de donn√©es esturgeon :</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">esturgeon</span><span class="op">$</span><span class="va">lfklngth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">esturgeon</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fklngth</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">esturgeon</span><span class="op">$</span><span class="va">lrdwght</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">$</span><span class="va">rdwght</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vous pouvez ensuite obtenir la matrice de corr√©lation par :</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fklngth"</span>, <span class="st">"lfklngth"</span>, <span class="st">"lrdwght"</span>, <span class="st">"rdwght"</span><span class="op">)</span><span class="op">]</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fr√©quemment, il y a des donn√©es manquantes dans un √©chantillon. En pr√©cisant <code>use="complete.obs"</code>, toutes les lignes du fichier pour lesquelles les variables ne sont pas toutes mesur√©es sont √©limin√©es. Dans ce cas, toutes les corr√©lations seront calcul√©es avec le m√™me nombre de cas. Par contre, en utilisant <code>use="pairwise.complete.obs"</code>, R √©limine une observation seulement lorsque l‚Äôun des deux membres de la paire a une valeur manquante. Dans ce cas, si les donn√©es manquantes pour diff√©rentes variables se retrouvent dans un groupe diff√©rent d‚Äôobservation, les corr√©lations ne seront pas n√©cessairement calcul√©es sur le m√™me nombre de cas ni sur le m√™me sous-ensemble de cas. En g√©n√©ral, vous devriez utiliser l‚Äôoption <code>use="complete.obs"</code> √† moins que vous ayez un tr√®s grand nombre de donn√©es manquantes et que cette fa√ßon de proc√©der √©limine la plus grande partie de vos observations.</p>
<p>Pourquoi la corr√©lation entre les variables originales est-elle plus faible qu‚Äôentre les variables transform√©es ?</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">esturgeon</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fklngth"</span>, <span class="st">"lfklngth"</span>, <span class="st">"lrdwght"</span>, <span class="st">"rdwght"</span><span class="op">)</span><span class="op">]</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           fklngth  lfklngth   lrdwght    rdwght
fklngth  1.0000000 0.9921435 0.9645108 0.9175435
lfklngth 0.9921435 1.0000000 0.9670139 0.8756203
lrdwght  0.9645108 0.9670139 1.0000000 0.9265513
rdwght   0.9175435 0.8756203 0.9265513 1.0000000</code></pre>
</div>
</div>
<p>Il y a plusieurs choses √† noter ici.</p>
<ul>
<li>Premi√®rement, la corr√©lation entre la longueur (‚Äúfklngth‚Äù) et le poids (‚Äúrdwght‚Äù) est √©lev√©e, peu importe la transformation: les poissons lourds ont tendance √† √™tre longs.</li>
<li>Deuxi√®mement, la corr√©lation est plus forte pour les donn√©es transform√©es que pour les donn√©es brutes.</li>
</ul>
<p><strong>Pourquoi?</strong> Parce que le coefficient de corr√©lation est inversement proportionnel au bruit autour de la relation lin√©aire. Si la relation est curvilin√©aire (comme dans le cas des donn√©es non transform√©es), le bruit est plus grand que si la relation est parfaitement lin√©aire. Par cons√©quent, la corr√©lation est plus faible.</p>
</section><section id="matrices-de-corr√©lations-et-correction-de-bonferroni" class="level2" data-number="9.4"><h2 data-number="9.4" class="anchored" data-anchor-id="matrices-de-corr√©lations-et-correction-de-bonferroni">
<span class="header-section-number">9.4</span> Matrices de corr√©lations et correction de Bonferroni</h2>
<p>Une pratique courante est d‚Äôexaminer la matrice de corr√©lation √† la recherche d‚Äôassociations significatives. Comme exemple, essayons de tester si la corr√©lation entre <code>lfklngth</code> et <code>rdwght</code> est significative (le plus faible coefficient de corr√©lation de cette matrice).</p>
<ul>
<li>Estimez la corr√©lation entre la longueur (<code>fklngth</code> et le poids (<code>rdwght</code>) des esturgeons:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span></span>
<span>  <span class="va">esturgeon</span><span class="op">$</span><span class="va">lfklngth</span>, <span class="va">esturgeon</span><span class="op">$</span><span class="va">rdwght</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"pearson"</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  esturgeon$lfklngth and esturgeon$rdwght
t = 24.322, df = 180, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.8367345 0.9057199
sample estimates:
      cor 
0.8756203 </code></pre>
</div>
</div>
<p>On voit ici que la corr√©lation est hautement significative (<span class="math inline">\(p &lt; 2.2e-16\)</span>), ce qui n‚Äôest pas surprenant √©tant donn√© la valeur du coefficient de corr√©lation (0.8756 = 87.6%). Il est important de r√©aliser que si une matrice contient un grand nombre de corr√©lations, il n‚Äôest pas surprenant d‚Äôen trouver au moins une qui soit ‚Äúsignificative‚Äù. En effet, on s‚Äôattend √† en trouver 5% en moyenne lorsqu‚Äôil n‚Äôy a en fait aucune corr√©lation entre les paires de moyennes (correspondant au risque d‚Äôerreur de type I <span class="math inline">\(\alpha\)</span>) <!-- JULIEN - Extra -->. Une fa√ßon de corriger pour cette tendance est d‚Äôajuster le niveau <span class="math inline">\(\alpha\)</span> critique auquel on attribue une signification statistique en divisant <span class="math inline">\(\alpha\)</span> par le nombre <span class="math inline">\(k\)</span> de corr√©lations qui sont examin√©es :</p>
<p><span class="math inline">\(\alpha' = \alpha / k\)</span> (ajustement de Bonferroni).</p>
<p>Si initialement <span class="math inline">\(\alpha = 0.05\)</span> et qu‚Äôil y a 10 corr√©lations qui sont examin√©es, alors <span class="math inline">\(\alpha'= 0.005\)</span>. Donc, afin de rejeter l‚Äôhypoth√®se nulle, la valeur de p devra √™tre plus petite que <span class="math inline">\(\alpha'\)</span>, en l‚Äôoccurrence 0.005. Dans l‚Äôexemple qui pr√©c√®de, on devrait donc ajuster <span class="math inline">\(\alpha\)</span> critique en divisant par le nombre total de corr√©lations dans la matrice (6 dans ce cas, donc <span class="math inline">\(\alpha'=0.00833\)</span>). Cette correction modifie-t-elle votre conclusion quant √† la corr√©lation entre <code>lkflngth</code> et <code>rdwght</code>?</p>
</section><section id="corr√©lations-non-param√©triques-r-de-spearman-et-tau-de-kendall" class="level2" data-number="9.5"><h2 data-number="9.5" class="anchored" data-anchor-id="corr√©lations-non-param√©triques-r-de-spearman-et-tau-de-kendall">
<span class="header-section-number">9.5</span> Corr√©lations non param√©triques: <em>r</em> de Spearman et <span class="math inline">\(\tau\)</span> de Kendall</h2>
<p>L‚Äôanalyse faite dans la section pr√©c√©dente avec les esturgeons sugg√®re que l‚Äôune des conditions pr√©alables √† l‚Äôanalyse de corr√©lation, soit la distribution normale bivari√©e de donn√©es, pourrait ne pas √™tre remplie pour <code>fklngth</code> et <code>rdwght</code>, ni pour les paires de variables transform√©es. La recherche d‚Äôune transformation appropri√©e peut parfois √™tre difficile. Pire encore, pour certaines distributions il n‚Äôexiste pas de transformation qui va normaliser les donn√©es. Dans ces cas-l√†, la meilleure option est de faire une analyse non param√©trique qui ne pr√©sume ni de la normalit√© ni de la lin√©arit√©. Ces analyses sont bas√©es sur les rangs. Les deux plus communes sont le coefficient de rang de Spearman et le <span class="math inline">\(\tau\)</span> (tau) de Kendall.</p>
<ul>
<li>Dans R, testez la corr√©lation entre <code>fklngth</code> et <code>rdwght</code> en utilisant Spearman et Kendall‚Äôs .</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span></span>
<span>  <span class="va">esturgeon</span><span class="op">$</span><span class="va">lfklngth</span>, <span class="va">esturgeon</span><span class="op">$</span><span class="va">rdwght</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"spearman"</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor.test.default(esturgeon$lfklngth, esturgeon$rdwght, alternative =
"two.sided", : Cannot compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  esturgeon$lfklngth and esturgeon$rdwght
S = 47971, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.9522546 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span></span>
<span>  <span class="va">esturgeon</span><span class="op">$</span><span class="va">lfklngth</span>, <span class="va">esturgeon</span><span class="op">$</span><span class="va">rdwght</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"kendall"</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kendall's rank correlation tau

data:  esturgeon$lfklngth and esturgeon$rdwght
z = 16.358, p-value &lt; 2.2e-16
alternative hypothesis: true tau is not equal to 0
sample estimates:
      tau 
0.8208065 </code></pre>
</div>
</div>
<p>Comparer les r√©sultats de cette analyse √† l‚Äôanalyse param√©trique. Pourquoi y-a-t‚Äôil une diff√©rence ?</p>
<p>Calculez les corr√©lations non param√©triques sur les paires de variables transform√©es. Vous devriez voir tout de suite que les corr√©lations des donn√©es transform√©es et non transform√©es sont identiques puisque dans les deux cas la corr√©lation est calcul√©e √† partir des rangs qui ne sont pas affect√©s par la transformation.</p>
<p>Notez que les corr√©lations obtenues avec le <span class="math inline">\(\tau\)</span> de Kendall (0.820) sont plus faibles que celles du coefficient de Spearman (0.952). Le <span class="math inline">\(\tau\)</span> de Kendall pond√®re un peu plus les grandes diff√©rences entre les rangs alors que le coefficient de Spearman donne le m√™me poids √† chaque paire d‚Äôobservations. En g√©n√©ral, on pr√©f√®re le <span class="math inline">\(\tau\)</span> de Kendall lorsqu‚Äôil y a plus d‚Äôincertitude quant aux rangs qui sont pr√®s les uns des autres.</p>
<p>Les esturgeons de cet √©chantillon ont √©t√© captur√©s √† l‚Äôaide de filets et d‚Äôhame√ßons d‚Äôune taille fixe. Quel impact cette m√©thode de capture peut-elle avoir eu sur la forme de la distribution de <code>fklngth</code> et <code>rdwght</code>? Compte tenu de ces circonstances, l‚Äôanalyse de corr√©lation est-elle appropri√©e ?</p>
<p>Rappelez-vous que l‚Äôanalyse de corr√©lation pr√©sume aussi que chaque variable est √©chantillonn√©e al√©atoirement. Dans le cas de nos esturgeons, ce n‚Äôest pas le cas: les hame√ßons app√¢t√©s et les filets ne capturent pas de petits esturgeons (et c‚Äôest pourquoi il n‚Äôy en a pas dans l‚Äô√©chantillon). Il faut donc r√©aliser que les coefficients de corr√©lation obtenus dans cette analyse ne refl√®tent pas n√©cessairement ceux de la population totale des esturgeons.</p>
</section><section id="sec-simple-lm" class="level2" data-number="9.6"><h2 data-number="9.6" class="anchored" data-anchor-id="sec-simple-lm">
<span class="header-section-number">9.6</span> R√©gression lin√©aire simple</h2>
<p>L‚Äôanalyse de corr√©lation vise √† d√©crire comment deux variables covarient. L‚Äôanalyse de r√©gression vise plut√¥t √† produire un mod√®le permettant de pr√©dire une variable (la variable d√©pendante) par l‚Äôautre (la variable ind√©pendante).</p>
<p>Comme pour l‚Äôanalyse de corr√©lation, on devrait commencer en examinant des graphiques. Puisque l‚Äôon veut quantifier la relation entre deux variables, un graphique de la variable d√©pendante (Y) en fonction de la variable ind√©pendante (X) est tout √† fait appropri√©.</p>
<ul>
<li>Le fichier <code>sturgeon.csv</code> contient les donn√©es d‚Äôun inventaire d‚Äôesturgeons r√©colt√©s entre 1978 et 1980 √† Cumberland House en Saskatchewan et √† The Pas au Manitoba. Faites un diagramme de dispersion de <code>fklngth</code> (la variable d√©pendante, <strong>Y</strong>) en fonction de l‚Äô<code>age</code> (la variable ind√©pendante, <strong>X</strong>) pour les esturgeons m√¢les uniquement et ajoutez-y une r√©gression lin√©aire et une ‚Äúlowess‚Äù. Que concluez-vous de ce diagramme de dispersion ?</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">esturgeon.male</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">esturgeon</span>, subset <span class="op">=</span> <span class="va">sex</span> <span class="op">==</span> <span class="st">"MALE"</span><span class="op">)</span></span>
<span><span class="va">mongraph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">esturgeon.male</span>, <span class="co"># origine des donn√©es</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">fklngth</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="co"># aesthetics: y=fklngth, x=rdwght</span></span>
<span><span class="co"># Repr√©sentez les donn√©es sous forme de Points, R√©gression lin√©aire, "Lowess"</span></span>
<span><span class="va">mongraph</span> <span class="op">&lt;-</span> <span class="va">mongraph</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Ajoutez une r√©gression lin√©aire, mais sans l'erreur-type (en vert)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Ajoutez la "lowess" (en rouge)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span><span class="co"># Ajoutez les donn√©es sous forme de points</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, y <span class="op">=</span> <span class="st">"Longueur"</span><span class="op">)</span> <span class="co"># Modifiez les noms des axes pour rendre le graphique plus lisible</span></span>
<span><span class="va">mongraph</span> <span class="co"># Affichez le graphique</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sturlm-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sturlm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-sturlm-1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sturlm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.5: Graphique de la longueur en fonction de l‚Äô√¢ge des esturgeons males.
</figcaption></figure>
</div>
</div>
</div>
<p>Ce graphique sugg√®re que la relation n‚Äôest pas lin√©aire.</p>
<p>Supposons que nous d√©sirions estimer le taux de croissance des esturgeons m√¢les. Un estim√© (peut-√™tre pas terrible‚Ä¶) du taux de croissance peut √™tre obtenu en calculant la pente de la r√©gression de la longueur en fonction de l‚Äô√¢ge.</p>
<p>Ajustons d‚Äôabord une r√©gression avec la commande <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> et sauvons ces r√©sultats dans un objet appel√© <code>RegModel.1</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">RegModele.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fklngth</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">esturgeon.male</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rien n‚Äôapparait √† l‚Äô√©cran, c‚Äôest normal ne vous inqui√©tez pas, tout a √©t√© sauvegard√© en m√©moire (nouvel objet visible dans l‚Äôonglet environnement) <!-- JULIEN - Extra - La parenth√®se sur l'environnement -->. Pour voir les r√©sultats, tapez:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">RegModele.1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = fklngth ~ age, data = esturgeon.male)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.4936 -2.2263  0.1849  1.7526 10.8234 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 28.50359    1.16873   24.39   &lt;2e-16 ***
age          0.70724    0.05888   12.01   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.307 on 73 degrees of freedom
  (5 observations deleted due to missingness)
Multiple R-squared:  0.664, Adjusted R-squared:  0.6594 
F-statistic: 144.3 on 1 and 73 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>la sortie R donne:</p>
<ol type="1">
<li>
<code>Call:</code> Un petit rappel du mod√®le qui a √©t√© ajust√© et des donn√©es utilis√©es.</li>
<li>
<code>Residuals:</code> Un sommaire statistique des r√©sidus autour du mod√®le estim√©.</li>
<li>
<code>Coefficients:</code> Valeurs estim√©es des param√®tres du mod√®le, erreurs-types, statistiques t et probabilit√©s associ√©es.</li>
<li>
<code>Residual standard error:</code> Racine carr√©e de la variance r√©siduelle.</li>
<li>
<code>Multiple R-squared:</code> Coefficient de d√©termination. Il correspond √† la proportion de la variabilit√© de la variable d√©pendante qui peut √™tre expliqu√©e par la r√©gression.</li>
<li>
<code>Adjusted R-squared:</code> Le R-carr√© ajust√© tient compte du nombre de param√®tres du mod√®le. Si vous voulez comparer diff√©rents mod√®les qui n‚Äôont pas le m√™me nombre de param√®tres, c‚Äôest ce qu‚Äôil faut utiliser.</li>
<li>
<code>F-statistic:</code> C‚Äôest le test de signification omnibus du mod√®le. Dans le cas de la r√©gression simple, il est √©quivalent au test sur la pente de la r√©gression.</li>
</ol>
<p>La r√©gression estim√©e est donc:</p>
<p><span class="math display">\[ Fklngth = 28.50359 + 0.70724 * age\]</span></p>
<p>√âtant donn√© la valeur significative du test de F (ainsi que pour le test de t pour la pente de la droite), on rejette l‚Äôhypoth√®se nulle qu‚Äôil n‚Äôy a pas de relation entre la taille et l‚Äô√¢ge.</p>
<section id="sec-cond-verif" class="level3" data-number="9.6.1"><h3 data-number="9.6.1" class="anchored" data-anchor-id="sec-cond-verif">
<span class="header-section-number">9.6.1</span> V√©rifier les conditions d‚Äôapplication de la r√©gression</h3>
<p>La r√©gression simple de type I a quatre conditions pr√©alables :</p>
<ol type="1">
<li>il n‚Äôy a <strong>pas d‚Äôerreur de mesure</strong> sur la variable ind√©pendante (X)</li>
<li>la relation entre Y et X est <strong>lin√©aire</strong>
</li>
<li>les r√©sidus sont <strong>normalement distribu√©s</strong>
</li>
<li>la variance des r√©sidus est constante pour toutes les valeurs de la variable ind√©pendante (<strong>homoscedasticit√©</strong>)</li>
</ol>
<p>Proc√©dons maintenant √† l‚Äôexamen post-mortem. La premi√®re condition est rarement remplie avec des donn√©es biologiques ; il y presque toujours de l‚Äôerreur sur X et sur Y. Cela veut dire qu‚Äôen g√©n√©ral les pentes estim√©es sont biais√©es, mais que les valeurs pr√©dites ne le sont pas. Toutefois, si l‚Äôerreur de mesure sur X est petite par rapport √† l‚Äô√©tendue des valeurs de X, le r√©sultat de l‚Äôanalyse n‚Äôest pas dramatiquement influenc√©. Par contre, si l‚Äôerreur de mesure est relativement grande (toujours par rapport √† l‚Äô√©tendue des valeurs de X), la droite de r√©gression obtenue par la r√©gression de mod√®le I est un pi√®tre estim√© de la relation fonctionnelle entre X et Y. Dans ce cas, il est pr√©f√©rable de passer √† la r√©gression de mod√®le II, malheureusement au-del√† du contenu de ce cours. Les autres conditions pr√©alables √† l‚Äôanalyse de r√©gression de mod√®le I peuvent cependant √™tre v√©rifi√©es, ou du moins √©valu√©es visuellement. La fonction <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> (appliqu√© directement sur un objet de type <code>model</code>) permet de visualiser des graphiques diagnostiques pour des mod√®les lin√©aires.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">RegModele.1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La fonction <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> est utilis√©e pour dire √† R de tracer 2 rang√©es et 2 colonnes de graphiques par page (il y a quatre graphiques diagnostiques qui sont g√©n√©r√©s automatiquement pour les mod√®les lin√©aires), et l‚Äôargument <code>las =</code> indique √† R d‚Äôeffectuer une rotation des l√©gendes des axes Y pour qu‚Äôelles soient perpendiculaires √† l‚Äôaxe (oui. Je sais. Rien de tout √ßa n‚Äôest √©vident.)</p>
<p>Vous obtiendrez:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sturlmv-1eval" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sturlmv-1eval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-sturlmv-1eval-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sturlmv-1eval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.6: Graphiques diagnostiques du mod√®le.
</figcaption></figure>
</div>
</div>
</div>
<ol type="1">
<li>
<strong>Le graphique en haut √† gauche</strong>, permet d‚Äô√©valuer la <strong>lin√©arit√©</strong>, la <strong>normalit√©</strong>, et l‚Äô<strong>homosc√©dasticit√©</strong> des r√©sidus. Il illustre les d√©viations autour de la r√©gression en fonction des valeurs pr√©dites. Rappelez-vous que le graphique de <code>fklngth</code> vs <code>age</code> sugg√®re que la relation entre la longueur et l‚Äô√¢ge n‚Äôest pas lin√©aire. Les tr√®s jeunes et tr√®s vieux esturgeons sont sous la droite en g√©n√©ral, alors que les esturgeons d‚Äô√¢ge moyen sont retrouv√©s g√©n√©ralement au-dessus de la droite de r√©gression. C‚Äôest exactement ce que le graphique des r√©sidus en fonction des valeurs pr√©dites illustre. La ligne en rouge est une trace ‚Äúlowess‚Äù au travers de ce nuage de points. Si la relation √©tait lin√©aire, la trace ‚Äúlowess‚Äù serait presque plate et pr√®s de 0. La dispersion des r√©sidus permet d‚Äô√©valuer visuellement leur normalit√© et h√©t√©rosc√©dasticit√©; mais ce graphique n‚Äôest pas optimal pour √©valuer ces propri√©t√©s. Les deux graphiques suivants sont mieux pour cela.</li>
<li>Le graphique en haut √† droite permet d‚Äô√©valuer la <strong>normalit√©</strong> des r√©sidus. C‚Äôest un graphique QQ des r√©sidus (QQ plot). Des r√©sidus distribu√©s normalement tomberaient exactement sur la diagonale. Ici, on voit que c‚Äôest presque le cas, sauf dans les queues de la distribution.</li>
<li>
<strong>Le graphique en bas √† gauche</strong>, intitul√© Scale-Location, permet d‚Äô√©valuer l‚Äô<strong>homosc√©dasticit√©</strong>. On y retrouve sur l‚Äôordonn√©e (l‚Äôaxe des y) la racine carr√©e de la valeur absolue des r√©sidus standardis√©s (r√©sidus divis√©s par l‚Äô√©cart-type des r√©sidus) en fonction des valeurs pr√©dites. Le graphique aide √† d√©terminer si la variation des r√©sidus est constante ou non. Si les r√©sidus sont homosc√©dastiques, la valeur moyenne sur l‚Äôaxe des y ne va pas changer en fonction de la valeur pr√©dite. Ici, il y a une certaine tendance, mais pas une tendance monotone puisqu‚Äôil y a d‚Äôabord une baisse puis une hausse..; bref, rien qui soit une forte √©vidence contre la supposition d‚Äôhomosc√©dasticit√©.</li>
<li>
<strong>Le graphique en bas √† droite</strong>, montre les r√©sidus en fonction du ‚Äúleverage‚Äù et permet de d√©tecter certaines <strong>valeurs extr√™mes</strong> qui ont une grande influence sur la r√©gression. Le leverage d‚Äôun point mesure sa distance des autres points, mais seulement en ce qui concerne les variables ind√©pendantes. Dans le cas d‚Äôune r√©gression simple, cela revient √† la distance entre le point sur l‚Äôaxe des x et la moyenne de tous les points sur cet axe. Vous devriez porter une attention particuli√®re aux observations qui ont un leverage plus grand que <span class="math inline">\(2(k+1)/n\)</span>, o√π k est le nombre de variables ind√©pendantes (ici, 1) et n est le nombre d‚Äôobservations. Dans cet exemple, il y a 75 observations et une variable ind√©pendante et donc les points ayant un leverage plus grand que <span class="math inline">\(4 / 75 =  0.053\)</span> devrait √™tre consid√©r√©s avec attention. Le graphique indique √©galement comment la r√©gression changerait si on enlevait un point. Ce changement est mesur√© par la distance de Cook, illustr√©e par les bandes en rouge sur le graphique. Un point ayant une distance de Cook sup√©rieure √† 1 a une grande influence.</li>
</ol>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Avertissement
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notez que R identifie automatiquement les cas les plus extr√™mes sur chacun de ces 4 graphiques. Le fait qu‚Äôun point soit identifi√© ne signifie pas n√©cessairement que c‚Äôest une valeur r√©ellement extr√™me, ou que vous devez vous en pr√©occuper. Dans tous les ensembles de donn√©es il y aura toujours un r√©sidu plus grand que les autres‚Ä¶</p>
</div>
</div>
<p>Il est possible d‚Äôobtenir des graphiques d‚Äô√©valuations des conditions d‚Äôapplications, qui sont plus simple √† interpr√©ter et plus joli (avec des couleurs). On peut utiliser la fonction <code><a href="https://easystats.github.io/performance/reference/check_model.html">check_model()</a></code> du paquet <code>performance</code> <span class="emoji" data-emoji="package">üì¶</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">RegModele.1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-check" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-check-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.7: Graphiques diagnostiques du mod√®le avec la fonction <code><a href="https://easystats.github.io/performance/reference/check_model.html">check_model()</a></code>.
</figcaption></figure>
</div>
</div>
</div>
<p>Finalement, quel est le verdict concernant la r√©gression lin√©aire entre <code>fklngth</code> et <code>age</code> ? Elle viole la condition de lin√©arit√©, possiblement celle de normalit√©, remplit la condition d‚Äôhomosc√©dasticit√©, et ne semble pas √™tre influenc√©e outre mesure par des valeurs bizarres ou extr√™mes.</p>
</section><section id="tests-formels-des-conditions-dapplication-pour-la-r√©gression" class="level3" data-number="9.6.2"><h3 data-number="9.6.2" class="anchored" data-anchor-id="tests-formels-des-conditions-dapplication-pour-la-r√©gression">
<span class="header-section-number">9.6.2</span> Tests formels des conditions d‚Äôapplication pour la r√©gression</h3>
<p>Personnellement, je n‚Äôutilise jamais les tests formels des conditions d‚Äôapplication de la r√©gression et me contente des graphiques des r√©sidus pour guider mes d√©cisions. C‚Äôest ce que la plupart des praticiens font. Cependant, lors de mes premi√®res analyses, je n‚Äô√©tais pas toujours certain de bien interpr√©ter les graphiques et j‚Äôaurais aim√© un indice plus formel ou un test permettant de d√©tecter les violations des conditions d‚Äôapplication de la r√©gression.</p>
<p>Le package <code>lmtest</code> <span class="emoji" data-emoji="package">üì¶</span> (disponible sur CRAN), permet de faire plusieurs tests de lin√©arit√© et d‚Äôhomosc√©dasticit√©. Et on peut tester la normalit√© avec le test Shapiro-Wilk vu pr√©c√©demment.</p>
<p>Charger le package lmtest de CRAN (et installer le si besoin).</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercice
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ex√©cutez les commandes suivantes</p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">RegModele.1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  RegModele.1
BP = 1.1765, df = 1, p-value = 0.2781</code></pre>
</div>
</div>
<p>Le test Breusch-Pagan examine si la variabilit√© des r√©sidus est constantes lorsque les valeurs pr√©dites changent. Une faible valeur de p sugg√®re de l‚Äôh√©t√©rosc√©dasticit√©. Ici, la valeur p est √©lev√©e et sugg√®re que la condition d‚Äôapplication d‚Äôhomosc√©dasticit√© est remplie avec ces donn√©es.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="va">RegModele.1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  RegModele.1
DW = 2.242, p-value = 0.8489
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
<p>Le test Durbin-Watson permet de d√©tecter l‚Äôautocorr√©lation s√©rielle des r√©sidus. En l‚Äôabsence d‚Äôautocorr√©lation (i.e.&nbsp;d‚Äôind√©pendance des r√©sidus) la valeur attendue de la statistique D est 2. Ce test permet d‚Äô√©prouver l‚Äôhypoth√®se d‚Äôind√©pendance des r√©sidus, mais ne permet de d√©tecter qu‚Äôun type particulier de d√©pendance. Ici, le test ne permet pas de rejeter l‚Äôhypoth√®se d‚Äôind√©pendance.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest</a></span><span class="op">(</span><span class="va">RegModele.1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  RegModele.1
RESET = 14.544, df1 = 2, df2 = 71, p-value = 5.082e-06</code></pre>
</div>
</div>
<p>Le test RESET permet d‚Äô√©prouver la lin√©arit√©. Si la relation est lin√©aire, alors la statistique RESET sera d‚Äôenviron 1. Ici, la statistique est beaucoup plus √©lev√©e (14.54) et hautement significative. Le test confirme la tendance que nous avons d√©tect√©e visuellement plus haut: la relation n‚Äôest pas lin√©aire.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">RegModele.1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(RegModele.1)
W = 0.98037, p-value = 0.2961</code></pre>
</div>
</div>
<p>Le test de normalit√© Shapiro-Wilk sur les r√©sidus confirme que la d√©viation par rapport √† une distribution normale des r√©sidus n‚Äôest pas grande.</p>
</section></section><section id="transformation-des-donn√©es-en-r√©gression" class="level2" data-number="9.7"><h2 data-number="9.7" class="anchored" data-anchor-id="transformation-des-donn√©es-en-r√©gression">
<span class="header-section-number">9.7</span> Transformation des donn√©es en r√©gression</h2>
<p>La relation entre <code>fklngth</code> et <code>age</code> n‚Äô√©tant pas lin√©aire, on devrait donc essayer de transformer les donn√©es pour tenter de les lin√©ariser :</p>
<ul>
<li>Voyons ce qu‚Äôune transformation log donne:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">esturgeon.male</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fklngth</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sturtr-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sturtr-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-sturtr-1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sturtr-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.8: Graphique du log de la longueur en fonction du log de l‚Äô√¢ge des esturgeons males
</figcaption></figure>
</div>
</div>
</div>
<p>Ajustons maintenant une r√©gression simple sur ces donn√©es transform√©es.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">RegModele.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fklngth</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">esturgeon.male</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">RegModele.2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log10(fklngth) ~ log10(age), data = esturgeon.male)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.082794 -0.016837 -0.000719  0.021102  0.087446 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.19199    0.02723   43.77   &lt;2e-16 ***
log10(age)   0.34086    0.02168   15.72   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03015 on 73 degrees of freedom
  (5 observations deleted due to missingness)
Multiple R-squared:  0.772, Adjusted R-squared:  0.7688 
F-statistic: 247.1 on 1 and 73 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Examinons maintenant les graphiques diagnostiques:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">RegModele.2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sturtr-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sturtr-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-sturtr-3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sturtr-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.9: Graphiques diagnostiques du mod√®le avec les donn√©es log-transform√©es.
</figcaption></figure>
</div>
</div>
</div>
<p>Il y a une certaine am√©lioration, mais ce n‚Äôest pas encore parfait (la perfection n‚Äôest pas de ce monde‚Ä¶.). Le graphique des r√©sidus en fonction des valeurs pr√©dites sugg√®re encore une certaine non lin√©arit√©. Sur le graphique Q-Q les points se retrouvent plus pr√®s de la droite diagonale qu‚Äôavant, indiquant que les r√©sidus sont encore plus pr√®s de la normalit√© apr√®s la transformation log-log. Il n‚Äôy a pas d‚Äôindice d‚Äôh√©t√©rosc√©dasticit√©. Finalement, m√™me si il reste quelques points avec plus d‚Äôinfluence (leverage) que les autres, aucun n‚Äôa une distance de Cook au-del√† de 0.5. En r√©sum√©, la transformation log a am√©lior√© les choses: la relation est plus lin√©aire, les r√©sidus sont plus normaux, et il y a moins de points avec une influence relativement √©lev√©e. Est-ce que les tests formels supportent cette √©valuation ?</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">RegModele.2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  RegModele.2
BP = 0.14282, df = 1, p-value = 0.7055</code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="va">RegModele.2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  RegModele.2
DW = 2.1777, p-value = 0.6134
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest</a></span><span class="op">(</span><span class="va">RegModele.2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  RegModele.2
RESET = 4.4413, df1 = 2, df2 = 71, p-value = 0.01523</code></pre>
</div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">RegModele.2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(RegModele.2)
W = 0.98998, p-value = 0.8246</code></pre>
</div>
</div>
<p>Oui, les conclusions sont les m√™mes: les r√©sidus sont encore homosc√©dastiques (test Breusch-Pagan), ne sont pas autocorr√©l√©s (test Durbin-Watson), sont normaux (test Shapiro-Wilk), et sont plus lin√©aires (la valeur de P du test RESET est maintenant 0.015, au lieu de 0.000005). Donc la lin√©arit√© a augment√©, mais cette condition d‚Äôapplication semble encore l√©g√®rement viol√©e.</p>
</section><section id="traitement-des-valeurs-extr√™mes" class="level2" data-number="9.8"><h2 data-number="9.8" class="anchored" data-anchor-id="traitement-des-valeurs-extr√™mes">
<span class="header-section-number">9.8</span> Traitement des valeurs extr√™mes</h2>
<p>Dans cet exemple, il n‚Äôy a pas de valeur vraiment extr√™me. Oui, je sais, R a quand m√™me identifi√© les observations 8, 24, et 112 dans le dernier graphique diagnostique. Mais ces valeurs sont encore dans la fourchette de valeurs que je juge ‚Äúacceptables‚Äù. Mais comment d√©terminer objectivement ce qui est acceptable ? √Ä quel moment juge t‚Äôon qu‚Äôune valeur extr√™me est vraiment trop invraisemblable pour ne pas l‚Äôexclure ? Il n‚Äôy a malheureusement pas de r√®gle absolue l√†-dessus. Les opinions varient, mais je penche vers le conservatisme sur cette question.</p>
<p>Ma position est que, √† moins que la valeur soit biologiquement impossible ou clairement une erreur d‚Äôentr√©e de donn√©es, je n‚Äô√©limine pas les valeurs extr√™mes et j‚Äôutilise toutes mes donn√©es dans leur analyse. Pourquoi?</p>
<p>Parce que je veux que mes donn√©es refl√®tent bien la variabilit√© naturelle ou r√©elle. C‚Äôest d‚Äôailleurs parfois cette variabilit√© qui est int√©ressante.</p>
<p>L‚Äôapproche conservatrice qui consiste √† conserver toutes les valeurs extr√™mes possibles est possiblement la plus honn√™te, mais elle peut causer certains probl√®mes. Ces valeurs extr√™mes sont souvent la cause des violations des conditions d‚Äôapplication des tests statistiques. La solution sugg√©r√©e √† ce dilemme est de faire l‚Äôanalyse avec et sans les valeurs extr√™mes et de comparer les conclusions. Dans bien des cas, les conclusions seront qualitativement les m√™mes et les tailles d‚Äôeffet ne seront pas tr√®s diff√©rentes. Toutefois, dans certains cas, la pr√©sence des valeurs extr√™mes change compl√®tement les conclusions. Dans ces cas, il faut simplement accepter que les conclusions d√©pendent enti√®rement de la pr√©sence des valeurs extr√™mes et sont donc peu concluantes.</p>
<p>Suivant cette approche comparative, refaisons donc l‚Äôanalyse apr√®s avoir enlev√© les observations 8, 24, et 112.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">RegModele.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fklngth</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">esturgeon.male</span>, subset <span class="op">=</span> <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">esturgeon.male</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"8"</span>, <span class="st">"24"</span>, <span class="st">"112"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># On enl√®ve les observations 8, 24 et 112 du jeu de donn√©es</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">RegModele.3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log10(fklngth) ~ log10(age), data = esturgeon.male, 
    subset = !(rownames(esturgeon.male) %in% c("8", "24", "112")))

Residuals:
      Min        1Q    Median        3Q       Max 
-0.069163 -0.017390  0.000986  0.018590  0.047647 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.22676    0.02431   50.46   &lt;2e-16 ***
log10(age)   0.31219    0.01932   16.16   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02554 on 70 degrees of freedom
  (5 observations deleted due to missingness)
Multiple R-squared:  0.7885,    Adjusted R-squared:  0.7855 
F-statistic:   261 on 1 and 70 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>L‚Äôordonn√©e √† l‚Äôorigine (<code>Intercept</code>), la pente, et le R carr√© sont presque les m√™mes, et la valeur de p est encore astronomiquement petite. Enlever les valeurs extr√™mes a peu d‚Äôeffet dans ce cas.</p>
<p>Les graphiques diagnostiques des r√©sidus et les tests formels des conditions d‚Äôapplication sur ce sous-ensemble de donn√©es donnent :</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">RegModele.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">RegModele.3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  RegModele.3
BP = 0.3001, df = 1, p-value = 0.5838</code></pre>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="va">RegModele.3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  RegModele.3
DW = 2.0171, p-value = 0.5074
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest</a></span><span class="op">(</span><span class="va">RegModele.3</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    RESET test

data:  RegModele.3
RESET = 3.407, df1 = 2, df2 = 68, p-value = 0.0389</code></pre>
</div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">RegModele.3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(RegModele.3)
W = 0.98318, p-value = 0.4502</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-sturtr-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sturtr-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-sturtr-6-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sturtr-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.10: Graphiques diagnostiques du mod√®le RegModele.3 excluant les donn√©es aberrantes.
</figcaption></figure>
</div>
</div>
</div>
<p>Il n‚Äôy a pas vraiment de diff√©rence ici non plus avec l‚Äôanalyse des donn√©es en entier. Bref, tout pointe vers la conclusion que les valeurs les plus extr√™mes de cet ensemble de donn√©e n‚Äôinfluencent pas ind√ªment les r√©sultats statistiques.</p>
</section><section id="quantifier-la-taille-deffet-et-analyse-de-puissance-en-r√©gression" class="level2" data-number="9.9"><h2 data-number="9.9" class="anchored" data-anchor-id="quantifier-la-taille-deffet-et-analyse-de-puissance-en-r√©gression">
<span class="header-section-number">9.9</span> Quantifier la taille d‚Äôeffet et analyse de puissance en r√©gression</h2>
<p>L‚Äôinterpr√©tation biologique des r√©sultats n‚Äôest pas la m√™me chose que l‚Äôinterpr√©tation statistique. Dans l‚Äôanalyse qui pr√©c√®de, on conclue statistiquement que la taille augmente avec l‚Äô√¢ge (puisque la pente est positive et et <span class="math inline">\(p&lt;0.05\)</span>). Mais cette augmentation ‚Äústatistique‚Äù de la taille avec l‚Äô√¢ge ne donne pas d‚Äôinformations sur la diff√©rence de taille entre les jeunes et vieux individus. La pente et un graphique sont plus informatifs √† ce sujet que la valeur p. La pente (dans l‚Äôespace log-log) est de 0.34. Cela veut dire que pour chaque unit√© d‚Äôaccroissement de X (log10(age)), il y a une augmentation de 0.34 unit√©s de log10(fklngth). En d‚Äôautres mots, quand l‚Äô√¢ge est multipli√© par 10, la longueur est multipli√©e environ par 2 (10<sup>0.34</sup> = 2.19). Donc la longueur des esturgeons augmente plus lentement que leur √¢ge. La valeur de la pente (0.34) est un estim√© de la taille de l‚Äôeffet de l‚Äô√¢ge sur la longueur.</p>
<p>Il est aussi important d‚Äôestimer l‚Äôintervalle de confiance sur la pente pour pouvoir estimer si l‚Äôintervalle n‚Äôinclus ou non que des valeurs biologiquement importantes. Cela peut √™tre fait simplement avec la fonction <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">RegModele.2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %   97.5 %
(Intercept) 1.1377151 1.246270
log10(age)  0.2976433 0.384068</code></pre>
</div>
</div>
<p>L‚Äôintervalle de confiance √† 95% de la pente est 0.29-0.38. L,intervalle de confiance est assez √©troit et √©loign√© de z√©ro.</p>
<section id="puissance-de-d√©tecter-une-pente-donn√©e" class="level3" data-number="9.9.1"><h3 data-number="9.9.1" class="anchored" data-anchor-id="puissance-de-d√©tecter-une-pente-donn√©e">
<span class="header-section-number">9.9.1</span> Puissance de d√©tecter une pente donn√©e</h3>
<p>Pour les calculs de puissance avec G*Power vous devrez cependant utiliser une autre m√©trique de la taille de l‚Äôeffet, calcul√©e √† partir de la pente, de son erreur-type, et de la taille de l‚Äô√©chantillon (ce qui facilite les calculs pour G*Power, mais malheureusement pas pour vous) La m√©trique (d) est calcul√©e comme: <span class="math display">\[ d = \frac{b}{s_b\sqrt{n-k-1}} \]</span> o√π <span class="math inline">\(b\)</span> est l‚Äôestim√© de la pente, <span class="math inline">\(s_b\)</span> est l‚Äôerreur type de la pente, <span class="math inline">\(n\)</span> est le nombre d‚Äôobservations, et <span class="math inline">\(k\)</span> est le nombre de variables ind√©pendantes (1 pour la r√©gression lin√©aire simple).</p>
<p>Vous pouvez calculer approximativement la puissance avec G*Power pour une valeur de pente que vous jugez assez grande pour m√©riter d‚Äô√™tre d√©tect√©e. Choisissez <strong>Tests: Means: One group: difference from constant</strong>, l√†, vous devrez remplacer la valeur de <span class="math inline">\(b\)</span> dans l‚Äô√©quation pour la taille d‚Äôeffet (d) par la pente que vous voudriez d√©tecter, mais utiliser l‚Äôerreur type calcul√©e √† partir de vos donn√©es.</p>
<p>Par exemple, supposons que les ichthyologues consid√®rent qu‚Äôune pente de 0.1 pour la relation entre log10(fklngth) et log10(age) est signifiante biologiquement, et qu‚Äôils d√©sirent estimer la puissance de d√©tecter une telle pente √† partir d‚Äôun √©chantillon de 20 esturgeons. Les r√©sultats de la r√©gression log-log nous fournissent ce dont on a besoin:</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">RegModele.2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log10(fklngth) ~ log10(age), data = esturgeon.male)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.082794 -0.016837 -0.000719  0.021102  0.087446 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.19199    0.02723   43.77   &lt;2e-16 ***
log10(age)   0.34086    0.02168   15.72   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03015 on 73 degrees of freedom
  (5 observations deleted due to missingness)
Multiple R-squared:  0.772, Adjusted R-squared:  0.7688 
F-statistic: 247.1 on 1 and 73 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>L‚Äôerreur-type de la pente est 0.02168. Il y avait 75 poissons (n=75) dans l‚Äô√©chantillon de d√©part. On peut donc calculer la m√©trique de taille d‚Äôeffet pour G*Power <span class="math display">\[ d = \frac{b}{s_b\sqrt{n-k-1}} = \frac{0.1}{0.02168\sqrt{74-1-1}}=0.54\]</span></p>
<p>Arm√©s de cette taille d‚Äôeffet (une pente pr√©sum√©e de 0.1 et une variabilit√© autour de la r√©gression similaire √† la r√©gression de fklngth vs age), choisissez <strong>Tests: Means: One group: difference from constant</strong>, et entrez la valeur calcul√©e de d, alpha, et l‚Äôeffectif de l‚Äô√©chantillon pour calculer la puissance.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-lm-pow-fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lm-pow-fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/lm_pow_1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lm-pow-fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.11: Analyse de puissance pour N = 20 et pente = 0.1
</figcaption></figure>
</div>
</div>
</div>
<p>Dans R, il est possible de faire cette analyse avec le code suivant:</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr">pwr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># analyse de puissance</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, d <span class="op">=</span> <span class="fl">0.54</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, type <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 20
              d = 0.54
      sig.level = 0.05
          power = 0.6299804
    alternative = two.sided</code></pre>
</div>
</div>
<p>La puissance de d√©tecter une pente comme √©tant statistiquement significative (au niveau alpha), si la pente est 0.1, que la variabilit√© r√©siduelle autour de la r√©gression est semblable √† celle de notre √©chantillon (ce qui revient √† une taille d‚Äôeffet de 0.54, pour un √©chantillon de 20 esturgeons et alpha=0.05) est de 0.629. Seulement environ 2/3 des √©chantillons de cette taille d√©tecteraient un effet significatif de l‚Äô√¢ge sur <code>fklngth</code>.</p>
</section><section id="effectif-requis-pour-atteindre-une-puissance-d√©sir√©e-test-a-priori" class="level3" data-number="9.9.2"><h3 data-number="9.9.2" class="anchored" data-anchor-id="effectif-requis-pour-atteindre-une-puissance-d√©sir√©e-test-a-priori">
<span class="header-section-number">9.9.2</span> Effectif requis pour atteindre une puissance d√©sir√©e (test A-priori)</h3>
<p>Pour estimer la taille d‚Äô√©chantillon (effectif) requis pour avoir une puissance de 99% de d√©tecter un effet de l‚Äô√¢ge si la pente est 0.1 (sur une √©chelle log-log), avec alpha=0.05, on utilise la m√™me valeur de d (0.54):</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-lm-pow-fig-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lm-pow-fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/lm_pow_2.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lm-pow-fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.12: Analyse √† priori pour d√©terminer la taille d‚Äô√©chantillon pour une puissance de 0.99
</figcaption></figure>
</div>
</div>
</div>
<p>Dans R, il est possible de faire cette analyse avec le code suivant:</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr">pwr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># analyse de puissance</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pwr/man/pwr.t.test.html">pwr.t.test</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">65</span>, d <span class="op">=</span> <span class="fl">0.54</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span>, type <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 65
              d = 0.54
      sig.level = 0.05
          power = 0.9900297
    alternative = two.sided</code></pre>
</div>
</div>
<p>En augmentant la taille de l‚Äô√©chantillon √† 65, selon le m√™me sc√©nario que pr√©c√©demment, la puissance augmente √† 99%.</p>
</section></section><section id="bootstrap-en-r√©gression-simple-avec-r" class="level2" data-number="9.10"><h2 data-number="9.10" class="anchored" data-anchor-id="bootstrap-en-r√©gression-simple-avec-r">
<span class="header-section-number">9.10</span> Bootstrap en r√©gression simple avec R</h2>
<p>Un test non param√©trique pour l‚Äôordonn√©e √† l‚Äôorigine et la pente d‚Äôune r√©gression simple peut √™tre effectu√© par bootstrap.</p>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># charger le paquet boot</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span></span>
<span><span class="co"># obtenir les poids de r√©gression</span></span>
<span><span class="va">bs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">indices</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">indices</span>, <span class="op">]</span> <span class="co"># Permets √† boot de s√©lectionner les √©chantillons</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># bootstrap avec 1000 r√©plications</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html">boot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">esturgeon.male</span>,</span>
<span>  statistic <span class="op">=</span> <span class="va">bs</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">1000</span>, formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fklngth</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># R√©sultats</span></span>
<span><span class="va">results</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ORDINARY NONPARAMETRIC BOOTSTRAP


Call:
boot(data = esturgeon.male, statistic = bs, R = 1000, formula = log10(fklngth) ~ 
    log10(age))


Bootstrap Statistics :
     original       bias    std. error
t1* 1.1919926  0.002738410  0.03496594
t2* 0.3408557 -0.002021183  0.02769506</code></pre>
</div>
</div>
<p>Pour chaque param√®tre du mod√®le (ici l‚Äôordonn√©e √† l‚Äôorigine est appel√©e t1* et la pente de la r√©gression t2*), R imprime :</p>
<ol type="1">
<li>
<code>original</code> la valeur estim√©e sur tout l‚Äô√©chantillon</li>
<li>
<code>bias</code> la diff√©rence entre la valeur moyenne des estim√©s par bootstrap et la valeur originale sur tout l‚Äô√©chantillon</li>
<li>
<code>std. error</code> l‚Äôerreur-type de l‚Äôestim√© bootstrap</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">results</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># intercept</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">results</span>, index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># log10(age)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-lm-boot-2-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lm-boot-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-lm-boot-2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lm-boot-2-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.13: R√©sultats du test de bootstrap non param√©trique
</figcaption></figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-lm-boot-2-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lm-boot-2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="31-reg_lin_files/figure-html/fig-lm-boot-2-2.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lm-boot-2-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.14: R√©sultats du test de bootstrap non param√©trique
</figcaption></figure>
</div>
</div>
</div>
<p>La distribution des estim√©s obtenus par bootstrap est assez normale dans cet exemple, avec de petites d√©viations dans les queue de la distribution (l√† o√π √ßa compte pour les intervalles de confiance‚Ä¶). On pourrait utiliser l‚Äôerreur-type des estim√©s bootstrap pour calculer un intervalle de confiance sym√©trique (moyenne +- t E.T.). Cependant, comme R peut facilement calculer des intervalles de confiance qui corrigent pour le biais (BCa: ‚ÄúBias-Corrected Adjusted‚Äù) ou encore des intervalle empiriques √† partir des distributions simul√©es (m√©thode Percentile) il peut √™tre aussi simple de les calculer selon les 3 m√©thodes:</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># interval de confiance pour l'ordonn√©e √† l'origine</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html">boot.ci</a></span><span class="op">(</span><span class="va">results</span>, type <span class="op">=</span> <span class="st">"all"</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in boot.ci(results, type = "all", index = 1): bootstrap variances
needed for studentized intervals</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 1000 bootstrap replicates

CALL : 
boot.ci(boot.out = results, type = "all", index = 1)

Intervals : 
Level      Normal              Basic         
95%   ( 1.121,  1.258 )   ( 1.122,  1.256 )  

Level     Percentile            BCa          
95%   ( 1.128,  1.262 )   ( 1.116,  1.250 )  
Calculations and Intervals on Original Scale
Some BCa intervals may be unstable</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># intervalle de confiance pour la pente</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html">boot.ci</a></span><span class="op">(</span><span class="va">results</span>, type <span class="op">=</span> <span class="st">"all"</span>, index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in boot.ci(results, type = "all", index = 2): bootstrap variances
needed for studentized intervals</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 1000 bootstrap replicates

CALL : 
boot.ci(boot.out = results, type = "all", index = 2)

Intervals : 
Level      Normal              Basic         
95%   ( 0.2886,  0.3972 )   ( 0.2889,  0.3968 )  

Level     Percentile            BCa          
95%   ( 0.2849,  0.3928 )   ( 0.2950,  0.4019 )  
Calculations and Intervals on Original Scale
Some BCa intervals may be unstable</code></pre>
</div>
</div>
<p>Ici, les 4 types d‚Äôintervalles de confiance que R a calcul√© sont essentiellement semblables. Si les donn√©es avaient viol√© plus s√©v√®rement les conditions d‚Äôapplication de la r√©gression (normalit√©, homoscedasticit√©), alors les diff√©rentes m√©thodes (Normal, Basic, Percentile, et BCa) auraient diverg√© un peu plus. Lequel choisir alors? BCa est celui qui est pr√©f√©r√© de la majorit√© des praticiens, pr√©sentement.</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copi√©");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copi√©");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/biostats-uottawa\.github\.io\/enfR\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./25-puissance.html" class="pagination-link" aria-label="Analyse de puissance avec R et G\*Power">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Analyse de puissance avec R et G*Power</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./32-t_test.html" class="pagination-link" aria-label="Comparaison de deux √©chantillons">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Comparaison de deux √©chantillons</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://biostats-uottawa.github.io/people.html">Julien Martin</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/biostats-uottawa/enfR/edit/main/31-reg_lin.qmd" class="toc-action"><i class="bi bi-github"></i>Modifier cette page</a></li><li><a href="https://github.com/biostats-uottawa/enfR/issues/new" class="toc-action"><i class="bi empty"></i>Faire part d'un probl√®me</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Ce livre a √©t√© cr√©e avec <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>
